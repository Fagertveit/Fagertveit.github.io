!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ld37=e():t.ld37=e()}(this,function(){return function(t){function e(r){if(i[r])return i[r].exports;var o=i[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){t.exports=i(78)},function(t,e){"use strict";!function(t){t[t.POINT=0]="POINT",t[t.CIRCLE=1]="CIRCLE",t[t.VECTOR2=2]="VECTOR2",t[t.VECTOR3=3]="VECTOR3",t[t.LINE=4]="LINE",t[t.TRIANGLE=5]="TRIANGLE",t[t.RECTANGLE=6]="RECTANGLE",t[t.AABB=7]="AABB",t[t.POLYGON=8]="POLYGON",t[t.BEZIER=9]="BEZIER",t[t.BSPLINE=10]="BSPLINE"}(e.GeometricEnum||(e.GeometricEnum={})),e.GeometricEnum,e.GeometricName=["point","circle","vector2","vector3","line","triangle","rectangle","aabb","polygon","bezier","bspline"]},function(t,e,i){"use strict";var r=i(7),o=i(4);!function(t){t[t.VERTEX=0]="VERTEX",t[t.FRAGMENT=1]="FRAGMENT"}(e.ShaderType||(e.ShaderType={}));var n=e.ShaderType,s=function(){function t(t,e,i){this.gl=t,this.http=new r.Http(!1),this.resourceManager=o.ResourceManager.getInstance(),e&&i&&this.initShader(e,i)}return t.prototype.getProgram=function(){return this.program},t.prototype.loadShader=function(t,e){t===n.VERTEX?this.vertexShader=this.compileShader(t,e):this.fragmentShader=this.compileShader(t,e)},t.prototype.compileShader=function(t,e){var i;if(t===n.VERTEX)i=this.gl.createShader(this.gl.VERTEX_SHADER);else{if(t!==n.FRAGMENT)throw new Error("No valid shader type specified.");i=this.gl.createShader(this.gl.FRAGMENT_SHADER)}if(this.gl.shaderSource(i,e),this.gl.compileShader(i),!this.gl.getShaderParameter(i,this.gl.COMPILE_STATUS))throw new Error(this.gl.getShaderInfoLog(i));return i},t.prototype.createProgram=function(){if(this.program=this.gl.createProgram(),this.gl.attachShader(this.program,this.vertexShader),this.gl.attachShader(this.program,this.fragmentShader),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))throw new Error("Unable to initialize the shader program.");this.gl.useProgram(this.program)},t.prototype.initShader=function(t,e){var i=this;this.resourceManager.addOther(),this.http.get(t,function(t){i.loadShader(n.FRAGMENT,t.responseText)}),this.http.get(e,function(t){i.loadShader(n.VERTEX,t.responseText)}),this.resourceManager.otherReady(),this.createProgram()},t}();e.Program=s},function(t,e){"use strict";!function(t){t[t.RED=0]="RED",t[t.GREEN=1]="GREEN",t[t.BLUE=2]="BLUE",t[t.ALPHA=3]="ALPHA"}(e.RGBA||(e.RGBA={}));var i=e.RGBA;!function(t){t[t.HUE=0]="HUE",t[t.SATURATION=1]="SATURATION",t[t.LUMINOSITY=2]="LUMINOSITY",t[t.ALPHA=3]="ALPHA"}(e.HSLA||(e.HSLA={}));var r=e.HSLA,o=function(){function t(t,e,r,o){this.rgb=[255,255,255],this.hsl=[360,100,100],this.alpha=1,t&&e&&r&&(this.rgb[i.RED]=t,this.rgb[i.GREEN]=e,this.rgb[i.BLUE]=r,this.RGBtoHSL()),o&&(this.alpha=o)}return t.prototype.setRGB=function(t,e,r){this.rgb[i.RED]=t,this.rgb[i.GREEN]=e,this.rgb[i.BLUE]=r,this.RGBtoHSL()},t.prototype.setHSL=function(t,e,i){this.hsl[r.HUE]=t,this.hsl[r.SATURATION]=e,this.hsl[r.LUMINOSITY]=i,this.HSLtoRGB()},t.prototype.setAlpha=function(t){this.alpha=t},t.prototype.getRGB=function(){return{r:this.rgb[i.RED],g:this.rgb[i.GREEN],b:this.rgb[i.BLUE]}},t.prototype.getHSL=function(){return{h:this.hsl[r.HUE],s:this.hsl[r.SATURATION],l:this.hsl[r.LUMINOSITY]}},t.prototype.getAlpha=function(){return this.alpha},t.prototype.getRGBAFloat=function(){return[this.toFloat(this.rgb[i.RED]),this.toFloat(this.rgb[i.GREEN]),this.toFloat(this.rgb[i.BLUE]),this.alpha]},t.prototype.RGBtoHSL=function(){var t,e,o,n=this.rgb[i.RED],s=this.rgb[i.GREEN],a=this.rgb[i.BLUE],h=n>s?n:s;a>h&&(h=a);var c=n<s?n:s;if(a<c&&(c=a),o=h/255,e=0!==h?(h-c)/h:0,0===e)t=0;else{var u=(h-n)/(h-c),l=(h-s)/(h-c),p=(h-a)/(h-c);t=n===h?p-l:s===h?2+u-p:4+l-u,t/=6,t<0&&(t+=1)}this.hsl[r.HUE]=t,this.hsl[r.SATURATION]=e,this.hsl[r.LUMINOSITY]=o},t.prototype.HSLtoRGB=function(){var t=0,e=0,o=0,n=this.hsl[r.HUE],s=this.hsl[r.SATURATION],a=this.hsl[r.LUMINOSITY];if(0===this.hsl[r.SATURATION])t=Math.floor(255*a+.5),e=Math.floor(255*a+.5),o=Math.floor(255*a+.5);else{var h=6*(n-Math.floor(n)),c=h-Math.floor(h),u=a*(1-s),l=a*(1-s*c),p=a*(1-s*(1-c));switch(Math.floor(h)){case 0:t=255*a+.5,e=255*p+.5,o=255*u+.5;break;case 1:t=255*l+.5,e=255*a+.5,o=255*u+.5;break;case 2:t=255*u+.5,e=255*a+.5,o=255*p+.5;break;case 3:t=255*u+.5,e=255*l+.5,o=255*a+.5;break;case 4:t=255*p+.5,e=255*u+.5,o=255*a+.5;break;case 5:t=255*a+.5,e=255*u+.5,o=255*l+.5}}this.rgb[i.RED]=Math.floor(t),this.rgb[i.GREEN]=Math.floor(e),this.rgb[i.BLUE]=Math.floor(o)},t.prototype.getHex=function(){return"#"+((1<<24)+(this.rgb[i.RED]<<16)+(this.rgb[i.GREEN]<<8)+this.rgb[i.BLUE]).toString(16).slice(1)},t.prototype.setHex=function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);this.rgb[i.RED]=parseInt(e[i.RED],16),this.rgb[i.GREEN]=parseInt(e[i.GREEN],16),this.rgb[i.BLUE]=parseInt(e[i.BLUE],16)},t.prototype.toFloat=function(t){return 0===t?0:t/255},t.prototype.toInt=function(t){return 255*t},t.prototype.interpolate=function(e,r,o){var n=new t,s=e.getRGBAFloat(),a=r.getRGBAFloat();return n.rgb[i.RED]=this.toInt(s[i.RED]+(a[i.RED]-s[i.RED])*o),n.rgb[i.GREEN]=this.toInt(s[i.GREEN]+(a[i.GREEN]-s[i.GREEN])*o),n.rgb[i.BLUE]=this.toInt(s[i.BLUE]+(a[i.BLUE]-s[i.BLUE])*o),n.alpha=this.toInt(s[i.ALPHA]+(a[i.ALPHA]-s[i.ALPHA])*o),n.RGBtoHSL(),n},t}();e.Color=o},function(t,e){"use strict";var i=function(){function t(){if(this.imageAssets=0,this.audioAssets=0,this.otherAssets=0,this.loadedImages=0,this.loadedAudio=0,this.loadedOther=0,this.failedImage=0,this.failedAudio=0,this.failedOther=0,t._instance)throw new Error("Error: Instantiation failed, Use ResourceManager.getInstance() instead of new.");t._instance=this}return t.getInstance=function(){return t._instance},t.prototype.getPercent=function(){return Math.ceil((this.loadedImages+this.loadedAudio+this.loadedOther)/(this.imageAssets+this.audioAssets+this.otherAssets))},t.prototype.isReady=function(){return this.loadedImages+this.loadedAudio+this.loadedOther===this.imageAssets+this.audioAssets+this.otherAssets},t.prototype.addImage=function(){this.imageAssets+=1},t.prototype.imageReady=function(){this.loadedImages+=1},t.prototype.imageFailed=function(){this.imageAssets-=1,this.failedImage+=1},t.prototype.addAudio=function(){this.audioAssets+=1},t.prototype.audioReady=function(){this.loadedAudio+=1},t.prototype.audioFailed=function(){this.audioAssets-=1,this.failedAudio+=1},t.prototype.addOther=function(){this.otherAssets+=1},t.prototype.otherReady=function(){this.loadedOther+=1},t.prototype.otherFailed=function(){this.otherAssets-=1,this.failedOther+=1},t._instance=new t,t}();e.ResourceManager=i},function(t,e,i){"use strict";var r=i(1),o=function(){function t(t,e){this.type=r.GeometricEnum.POINT,this.x=0,this.y=0,t&&(this.x=t),e&&(this.y=e)}return t.prototype.getType=function(){return this.type},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.setX=function(t){this.x=t},t.prototype.setY=function(t){this.y=t},t.prototype.set=function(t,e){this.x=t,this.y=e},t.prototype.get=function(){return this},t.prototype.transform=function(t,e){this.x+=t,this.y+=e},t}();e.Point=o},function(t,e){"use strict";var i=function(){function t(){this.flush()}return t.prototype.add=function(t){var e=this;this.vertices=this.vertices.concat(t.vertices),this.uvs=this.uvs.concat(t.uvs),t.indices.forEach(function(t){e.indices.push(t+e.index)}),this.index+=this.findMaxIndex(t.indices),this.numIndices+=t.numIndices},t.prototype.findMaxIndex=function(t){var e=0;return t.forEach(function(t){t>e&&(e=t)}),e+=1},t.prototype.flush=function(){this.vertices=[],this.indices=[],this.uvs=[],this.index=0,this.numIndices=0},t.prototype.setTexture=function(t){this.texture=t},t}();e.RenderCall=i},function(t,e){"use strict";var i=function(){function t(t){this.async=!1,t&&(this.async=t)}return t.prototype.get=function(t,e){var i=this.createXHR();i&&(i.open("GET",t,this.async),i.onreadystatechange=function(){4===i.readyState&&200===i.status&&e(i)},i.send(null))},t.prototype.createXHR=function(){try{return new XMLHttpRequest}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(t){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}return null},t}();e.Http=i},function(t,e){"use strict";function i(t){return t.charAt(0).toUpperCase()+t.slice(1)}e.PI=Math.PI,e.EPSILON=1e-7,e.capitalize=i},function(t,e,i){"use strict";var r=i(10);e.Geometry=r;var o=i(69);e.Graphics=o;var n=i(76);e.Utility=n;var s=i(72);e.Input=s;var a=i(56);e.GL=a;var h=i(37);e.Audio=h;var c=i(35);e.AI=c;var u=i(30);e.Scene=u.Scene;var l=i(36);e.Application=l.Application;var p=i(29);e.SceneManager=p.SceneManager},function(t,e,i){"use strict";var r=i(1);e.GeometricEnum=r.GeometricEnum,e.GeometricName=r.GeometricName;var o=i(11);e.Vector2=o.Vector2;var n=i(48);e.Vector3=n.Vector3;var s=i(5);e.Point=s.Point;var a=i(45);e.Line=a.Line;var h=i(43);e.Circle=h.Circle;var c=i(21);e.Rectangle=c.Rectangle;var u=i(40);e.AABB=u.AABB;var l=i(46);e.Polygon=l.Polygon;var p=i(41);e.Bezier=p.Bezier;var d=i(42);e.BSpline=d.BSpline;var f=i(47);e.Renderer=f.Renderer,e.render=f.render;var g=i(44);e.Collider=g.Collider,e.intersects=g.intersects},function(t,e,i){"use strict";var r=i(1),o=i(8),n=function(){function t(t,e){this.type=r.GeometricEnum.VECTOR2,this.x=0,this.y=0,t&&(this.x=t),e&&(this.y=e)}return t.prototype.getType=function(){return this.type},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.setX=function(t){this.x=t},t.prototype.setY=function(t){this.y=t},t.prototype.set=function(t,e){this.x=t,this.y=e},t.prototype.get=function(){return this},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y)},t.prototype.invert=function(){return new t(-this.x,-this.y)},t.prototype.scale=function(e){return new t(this.x*e,this.y*e)},t.prototype.normalize=function(){var e=this.length();return 0===e?new t(0,0):new t(this.x/e,this.y/e)},t.prototype.project=function(e){var i=this.dot(e),r=this.lengthSquared();return new t(i/r*this.x,i/r*this.y)},t.prototype.length=function(){return Math.sqrt(this.lengthSquared())},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y},t.prototype.cross=function(t){return this.x*t.y-this.y*t.x},t.prototype.angle=function(){return Math.atan2(this.x,-this.y)},t.prototype.copy=function(){return new t(this.x,this.y)},t.prototype.rotate=function(e){return 0===this.x&&(this.x+=o.EPSILON),0===this.y&&(this.y+=o.EPSILON),new t(Math.cos(e)*this.x-Math.sin(e)*this.y,Math.sin(e)*this.x+Math.cos(e)*this.y)},t.prototype.rotatePivot=function(e,i,r){0===this.x&&(this.x+=o.EPSILON),0===this.y&&(this.y+=o.EPSILON);var n=this.x,s=this.y;return n-=e,s-=i,new t(Math.cos(r)*n-Math.sin(r)*s+e,Math.sin(r)*n+Math.cos(r)*s+i)},t}();e.Vector2=n},function(t,e){"use strict";var i=function(){function t(t,e,i){this.gl=t,this.width=e,this.height=i,this.init()}return t.prototype.init=function(){var t=this.gl;if(this.fbo=t.createFramebuffer(),!this.fbo)throw new Error("Failed to create FBO.");if(this.texture=t.createTexture(),!this.texture)throw new Error("Failed to create FBO texture.");t.bindTexture(t.TEXTURE_2D,this.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR);var e=t.createRenderbuffer();if(!e)throw new Error("Failed to create depth buffer.");t.bindRenderbuffer(t.RENDERBUFFER,e),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,this.width,this.height),t.bindFramebuffer(t.FRAMEBUFFER,this.fbo),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.texture,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e);var i=t.checkFramebufferStatus(t.FRAMEBUFFER);if(t.FRAMEBUFFER_COMPLETE!==i)throw new Error("Framebuffer object is incomplete: "+i.toString());t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null)},t}();e.FrameBuffer=i},function(t,e,i){"use strict";var r=i(4),o=function(){function t(t,e){this.loaded=!1,this.ready=!1,this.gl=t,this.resourceManager=r.ResourceManager.getInstance(),e&&(this.url,this.load(e))}return t.prototype.load=function(t){var e=this,i=this.gl;this.resourceManager.addImage(),this.image=new Image,this.image.src=t,this.texture=i.createTexture(),this.image.addEventListener("load",function(t){e.loadHandler(t)}),this.image.addEventListener("error",e.errorHandler)},t.prototype.init=function(){var t=this.gl;t.bindTexture(t.TEXTURE_2D,this.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,this.image),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST),t.bindTexture(t.TEXTURE_2D,null),this.ready=!0},t.prototype.errorHandler=function(t){throw this.resourceManager&&this.resourceManager.imageFailed(),new Error("Failed to load sprite.")},t.prototype.loadHandler=function(t){this.loaded=!0,this.width=this.image.width,this.height=this.image.height,this.resourceManager.imageReady(),this.init()},t}();e.Texture=o},function(t,e){"use strict";var i=function(){function t(t,e){t&&(this.srcNode=t),e&&(this.dstNode=e)}return t.prototype.setCost=function(t){this.cost=t},t.prototype.getCost=function(){return this.cost},t.prototype.setSrcNode=function(t){this.srcNode=t},t.prototype.getSrcNode=function(){return this.srcNode},t.prototype.setDstNode=function(t){this.dstNode=t},t.prototype.getDstNode=function(){return this.dstNode},t}();e.Connection=i},function(t,e,i){"use strict";var r=i(14),o=function(){function t(t){t&&(this.nodes=t)}return t.prototype.setNodes=function(t){this.nodes=t},t.prototype.isValidNode=function(t,e){return!(t<0||e<0||e>=this.nodes.length||t>=this.nodes[0].length||this.nodes[e][t].getBlocked())},t.prototype.getNode=function(t){return this.nodes[t.y][t.x]},t.prototype.getConnections=function(t){for(var e,i=[],o=-1;o<2;o+=1)for(var n=-1;n<2;n+=1)0===o&&0===n||this.isValidNode(t.x+o,t.y+n)&&(e=new r.Connection,e.setSrcNode(t),e.setDstNode(this.nodes[t.y+n][t.x+o]),e.setCost(1),i.push(e));return i},t}();e.Graph=o},function(t,e){"use strict";var i=function(){function t(t){this.dstNode=t}return t.prototype.euclideanDistance=function(t){var e=t.x-this.dstNode.x,i=t.y-this.dstNode.y;return Math.sqrt(e*e+i*i)},t.prototype.manhattanDistance=function(t){var e=Math.abs(this.dstNode.x-t.x),i=Math.abs(this.dstNode.y-t.y);return e+i},t}();e.Heuristic=i},function(t,e){"use strict";var i=function(){function t(){this.list=[]}return t.prototype.add=function(t){this.list.push(t)},t.prototype.get=function(t){return this.list[t]},t.prototype.getSmallest=function(){var t,e;t=this.list[0];for(var i=0;i<this.list.length;i+=1)e=this.list[i],e.getEstimatedCost()<t.getEstimatedCost()&&(t=e);return t},t.prototype.contains=function(t){for(var e,i=0;i<this.list.length;i+=1)if(e=this.list[i].getNode(),e.x===t.x&&e.y===t.y)return!0;return!1},t.prototype.find=function(t){for(var e,i=0;i<this.list.length;i+=1)if(e=this.list[i].getNode(),e.x===t.x&&e.y===t.y)return this.list[i]},t.prototype.remove=function(t){for(var e,i=0;i<this.list.length;i+=1)e=this.list[i].getNode(),e.x===t.x&&e.y===t.y&&this.list.splice(i,1)},t.prototype.size=function(){return this.list.length},t}();e.NodeList=i},function(t,e){"use strict";var i=function(){function t(){this.currentCost=0,this.estimatedCost=0,this.currentCost=0,this.estimatedCost=0}return t.prototype.setNode=function(t){this.node=t},t.prototype.getNode=function(){return this.node},t.prototype.setConnection=function(t){this.connection=t},t.prototype.getConnection=function(){return this.connection},t.prototype.setCurrentCost=function(t){this.currentCost=t},t.prototype.getCurrentCost=function(){return this.currentCost},t.prototype.setEstimatedCost=function(t){this.estimatedCost=t},t.prototype.getEstimatedCost=function(){return this.estimatedCost},t}();e.NodeRecord=i},function(t,e){"use strict";var i=function(){function t(t,e){this.blocked=!1,this.x=t,this.y=e}return t.prototype.setBlocked=function(t){this.blocked=t},t.prototype.getBlocked=function(){return this.blocked},t}();e.Node=i},function(t,e){"use strict";e.CONTAINER_ID="gamesaw-container"},function(t,e,i){"use strict";var r=i(1),o=i(5),n=function(){function t(t,e,i,n){this.type=r.GeometricEnum.RECTANGLE,this.pos=new o.Point(0,0),this.width=1,this.height=1,t&&(this.pos.x=t),e&&(this.pos.y=e),i&&(this.width=i),n&&(this.height=n)}return t}();e.Rectangle=n},function(t,e){"use strict";var i=function(){function t(){this.pages={},this.glyphs={}}return t}();e.BitmapFont=i},function(t,e){"use strict";var i=function(){function t(t,e,i,r,o,n){this.pos=t,this.dir=e,this.size=i,this.vel=r,this.life=o,this.alpha=n}return t.prototype.update=function(t,e,i,r){this.life-=r,this.size+=i,this.dir.y+=t,this.dir.x+=e,this.pos.x+=this.dir.x*this.vel,this.pos.y+=this.dir.y*this.vel},t.prototype.isDead=function(){return this.life<0},t}();e.Particle=i},function(t,e){"use strict";var i=function(){function t(t,e,i,r,o,n,s,a,h,c){this.tiles=[],this.data=t,this.encoding=e,this.height=r,this.width=i,this.x=o,this.y=n,this.opacity=s,this.visible=a,this.name=h,this.type=c,this.decode()}return t.prototype.decode=function(){for(var t=atob(this.data),e=4,i=t.length/e,r=0;r<i;r+=1){this.tiles[r]=0;for(var o=e-1;o>=0;o-=1)this.tiles[r]+=t.charCodeAt(r*e+o)<<(o<<3)}},t.prototype.isVisible=function(){return this.visible},t.prototype.getTile=function(t){return{tileid:this.tiles[t],row:Math.floor(t/this.width),col:t%this.width}},t}();e.TilemapLayer=i},function(t,e,i){"use strict";var r=i(13),o=i(6),n=function(){function t(t,e,i,o,n,s,a,h,c,u,l,p){this.gl=t,this.name=e,this.image=i,this.imageWidth=o,this.imageHeight=n,this.firstgid=s,this.margin=a,this.spacing=h,this.columns=c,this.tileCount=u,this.tileWidth=l,this.tileHeight=p,this.lastgid=this.firstgid+this.tileCount-1,this.texture=new r.Texture(this.gl,this.image)}return t.prototype.renderTile=function(t,e,i,r){var n=Math.floor((r-this.firstgid)/this.columns),s=(r-this.firstgid)%this.columns,a=[s*this.tileWidth/this.imageWidth,n*this.tileHeight/this.imageHeight,(s*this.tileWidth+this.tileWidth)/this.imageWidth,(n*this.tileHeight+this.tileHeight)/this.imageHeight],h=new o.RenderCall;h.texture=this.texture.texture,h.vertices=[e,i,e+this.tileWidth,i,e,i+this.tileHeight,e+this.tileWidth,i+this.tileHeight],h.uvs=[a[0],a[1],a[2],a[1],a[0],a[3],a[2],a[3]],h.indices=[0,1,2,1,2,3],h.numIndices=6,t.addCall(h)},t.prototype.renderTileScale=function(t,e,i,r,n,s){var a=Math.floor((r-this.firstgid)/this.columns),h=(r-this.firstgid)%this.columns,c=[h*this.tileWidth/this.imageWidth,a*this.tileHeight/this.imageHeight,(h*this.tileWidth+this.tileWidth)/this.imageWidth,(a*this.tileHeight+this.tileHeight)/this.imageHeight],u=new o.RenderCall;u.texture=this.texture.texture,u.vertices=[e,i,e+this.tileWidth*n,i,e,i+this.tileHeight*n,e+this.tileWidth*n,i+this.tileHeight*n],u.uvs=[c[0],c[1],c[2],c[1],c[0],c[3],c[2],c[3]],u.indices=[0,1,2,1,2,3],u.numIndices=6,t.addCall(u)},t.prototype.renderTileAngle=function(t,e,i,r,o,n,s){},t}();e.Tileset=n},function(t,e,i){"use strict";var r=i(20),o=function(){function t(){}return t.prototype.createCanvas=function(){var t=document.getElementById(r.CONTAINER_ID);this.canvas=document.createElement("canvas"),this.canvas.setAttribute("id",this.id),this.canvas.setAttribute("width",String(this.width)),this.canvas.setAttribute("height",String(this.height)),this.canvas.style.position="absolute",t.appendChild(this.canvas)},t.prototype.toDataUrl=function(){return this.canvas.toDataURL("image/png")},t}();e.Surface=o},function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i(26),n=i(3),s=function(t){function e(e,i,r){t.call(this),this.width=640,this.height=480,this.id="canvas-2d",this.clearColor=new n.Color(0,0,0,1),this.width=e,this.height=i,this.id=r,this.createCanvas()}return r(e,t),e.prototype.clear=function(t){t&&(this.clearColor=t);var e=this.getContext();e.clearRect(0,0,this.width,this.height),t&&(e.save(),e.fillStyle=t.getHex(),e.fillRect(0,0,this.width,this.height),e.restore())},e.prototype.getContext=function(){return this.canvas.getContext("2d")},e}(o.Surface);e.Surface2d=s},function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},o=i(26),n=i(3),s=function(t){function e(e,i,r){t.call(this),this.clearColor=new n.Color(0,0,0,1),this.width=e,this.height=i,this.id=r,this.createCanvas(),this.init()}return r(e,t),e.prototype.init=function(){this.gl=this.getContext();var t=this.clearColor.getRGBAFloat();this.gl.clearColor(t[0],t[1],t[2],t[3])},e.prototype.clear=function(t){var e=this.gl;if(t){this.clearColor=t;var i=this.clearColor.getRGBAFloat();e.clearColor(i[0],i[1],i[2],i[3])}e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA)},e.prototype.getContext=function(){return this.canvas.getContext("webgl",{preserveDrawingBuffer:!0})||this.canvas.getContext("experimental-webgl",{preserveDrawingBuffer:!0})},e}(o.Surface);e.Surface3d=s},function(t,e,i){"use strict";var r=i(30),o=function(){function t(t){this.scenes={},this.application=t}return t.prototype.update=function(t){this.activeScene&&(this.scenes[this.activeScene].update(t),this.scenes[this.activeScene].render(t))},t.prototype.addScene=function(t){if(void 0!==this.scenes[t])throw new Error("Scene with id: "+t+" already exists.");return this.scenes[t]=new r.Scene(this.application),this.activeScene||(this.activeScene=t),this.scenes[t]},t.prototype.removeScene=function(t){delete this.scenes[t],this.activeScene===t&&(this.activeScene=this.getFirstScene())},t.prototype.getScene=function(t){if(void 0===this.scenes[t])throw new Error("Scene with id: "+t+" is undefined.");return this.scenes[t]},t.prototype.setActiveScene=function(t){if(void 0===this.scenes[t])throw new Error("Scene with id: "+t+" is undefined.");this.activeScene=t},t.prototype.getFirstScene=function(){for(var t in this.scenes)return t},t}();e.SceneManager=o},function(t,e,i){"use strict";var r=i(27),o=i(28),n=function(){function t(t){this.surfaces={},this.application=t}return t.prototype.add3dSurface=function(t){this.surfaces[t]=new o.Surface3d(this.application.width,this.application.height,t)},t.prototype.add2dSurface=function(t){this.surfaces[t]=new r.Surface2d(this.application.width,this.application.height,t)},t.prototype.getContext=function(t){return this.surfaces[t].getContext()},t.prototype.clear=function(t,e){e?this.surfaces[t].clear(e):this.surfaces[t].clear()},t}();e.Scene=n},function(t,e,i){"use strict";function r(t){return t*(n.PI/180)}function o(t){return t*(180/n.PI)}var n=i(8);e.degreeToRadian=r,e.radianToDegree=o},function(t,e,i){"use strict";var r=i(9),o=function(){function t(t,e,i,o,n,s){this.dead=!1,this.texture=e,this.sprite=new r.GL.Sprite(e,6,6,[406,22,6,6]),this.collider=i,this.speed=o,this.damage=n,this.direction=s}return t.prototype.isDead=function(){return this.dead},t.prototype.update=function(t){var e,i=new r.Geometry.Vector2(this.collider.pos.x,this.collider.pos.y);e=this.direction.scale(this.speed*t),i=i.add(e),this.collider.setX(i.x),this.collider.setY(i.y),(this.collider.pos.x>750||this.collider.pos.x<50||this.collider.pos.y>550||this.collider.pos.y<100)&&(this.dead=!0)},t.prototype.render=function(t){this.sprite.renderScale(t,this.collider.pos.x-this.collider.radius,this.collider.pos.y-this.collider.radius,2)},t}();e.Projectile=o},function(t,e,i){"use strict";var r=i(14);e.Connection=r.Connection;var o=i(15);e.Graph=o.Graph;var n=i(16);e.Heuristic=n.Heuristic;var s=i(17);e.NodeList=s.NodeList;var a=i(18);e.NodeRecord=a.NodeRecord;var h=i(19);e.Node=h.Node;var c=i(34);e.PathFinder=c.PathFinder},function(t,e,i){"use strict";var r=i(19),o=i(18),n=i(17),s=i(16),a=i(15),h=function(){function t(){this.startRecord=new o.NodeRecord,this.open=new n.NodeList,this.closed=new n.NodeList}return t.prototype.generatePathData=function(t,e){for(var i=[],o=0;o<t.height;o+=1){i[o]=[];for(var n=0;n<t.width;n+=1){var s=e.indexOf(t.tiles[o*t.width+n])!==-1;i[o][n]=new r.Node(n,o),i[o][n].setBlocked(s)}}this.graph=new a.Graph(i)},t.prototype.findPath=function(t,e){var i,r,a,h,c,u=[],l=[];if(this.startRecord=new o.NodeRecord,this.open=new n.NodeList,this.closed=new n.NodeList,this.heuristic=new s.Heuristic(e),this.graph.getNode(e).blocked)return null;for(this.startRecord.setNode(this.graph.getNode(t)),this.startRecord.setEstimatedCost(this.heuristic.euclideanDistance(this.startRecord.getNode())),this.open.add(this.startRecord);this.open.size()>0&&(i=this.open.getSmallest(),i.node.x!==e.x||i.node.y!==e.y);){l=this.graph.getConnections(i.getNode());for(var p=0;p<l.length;p+=1){if(r=l[p].getDstNode(),a=i.getCurrentCost()+l[p].getCost(),this.closed.contains(r)){if(h=this.closed.find(r),h.getCurrentCost()<=a)continue;this.closed.remove(h.getNode()),c=h.getEstimatedCost()-h.getCurrentCost()}else if(this.open.contains(r)){if(h=this.open.find(r),h.getCurrentCost()<=a)continue;c=h.getEstimatedCost()-h.getCurrentCost()}else h=new o.NodeRecord,h.setNode(r),c=this.heuristic.euclideanDistance(r);h.setCurrentCost(a),h.setConnection(l[p]),h.setEstimatedCost(a+c),this.open.contains(r)||this.open.add(h)}this.open.remove(i.getNode()),this.closed.add(i)}if(i.node.x!==e.x||i.node.y!==e.y)return null;for(;i.node.x!==t.x||i.node.y!==t.y;)u.push(i.connection.getDstNode()),i=this.closed.find(i.connection.getSrcNode());return u},t}();e.PathFinder=h},function(t,e,i){"use strict";var r=i(33);e.AStar=r},function(t,e,i){"use strict";var r=i(29),o=function(){function t(t,e,i){this.active=!0,this.targetFps=30,this.width=t,this.height=e,i&&(this.targetFps=i),this.sceneManager=new r.SceneManager(this)}return t.prototype.init=function(){this.lastDelta=(new Date).getTime(),this.start()},t.prototype.start=function(){var t=this;this.applicationTimer=window.setInterval(function(){t.update()},1e3/this.targetFps)},t.prototype.stop=function(){window.clearInterval(this.applicationTimer)},t.prototype.step=function(){this.update()},t.prototype.update=function(){var t=(new Date).getTime(),e=t-this.lastDelta;this.lastDelta=t,t-this.lastUpdate>1e3?(this.fps=this.frames,this.frames=0,this.lastUpdate=t):this.frames+=1,this.sceneManager.update(e)},t}();e.Application=o},function(t,e,i){"use strict";var r=i(38);e.Sample=r.Sample;var o=i(39);e.Track=o.Track},function(t,e,i){"use strict";var r=i(4),o=function(){function t(t){this.loaded=!1,t&&(this.url=t,this.load(t)),this.resourceManager=r.ResourceManager.getInstance()}return t.prototype.load=function(t){var e=this;this.sample=new Audio,this.sample.src=t,this.resourceManager.addAudio(),this.sample.addEventListener("load",function(t){e.loadHandler(t)}),this.sample.addEventListener("error",e.errorHandler)},t.prototype.play=function(){this.sample.currentTime=0,this.sample.play()},t.prototype.pause=function(){this.sample.pause()},t.prototype.stop=function(){this.sample.pause(),this.sample.currentTime=0},t.prototype.seek=function(t){this.sample.currentTime=t},t.prototype.setSpeed=function(t){this.sample.playbackRate=t},t.prototype.getSpeed=function(){return this.sample.playbackRate},t.prototype.loadHandler=function(t){this.loaded=!0,this.length=this.sample.duration,this.resourceManager.audioReady()},t.prototype.errorHandler=function(t){throw this.resourceManager.audioFailed(),new Error("Failed to load audio resource.")},t}();e.Sample=o},function(t,e,i){"use strict";var r=i(4),o=function(){function t(t){this.loop=!1,this.loaded=!1,t&&(this.url=t,this.load(t)),this.resourceManager=r.ResourceManager.getInstance()}return t.prototype.load=function(t){var e=this;this.track=new Audio,this.track.src=t,this.resourceManager.addAudio(),this.track.addEventListener("load",function(t){e.loadHandler(t)}),this.track.addEventListener("error",e.errorHandler)},t.prototype.play=function(){this.track.play()},t.prototype.pause=function(){this.track.pause()},t.prototype.stop=function(){this.track.pause(),this.track.currentTime=0},t.prototype.seek=function(t){this.track.currentTime=t},t.prototype.setSpeed=function(t){this.track.playbackRate=t},t.prototype.getSpeed=function(){return this.track.playbackRate},t.prototype.setLoopable=function(t){this.loop=t},t.prototype.loadHandler=function(t){this.loaded=!0,this.length=this.track.duration,this.resourceManager.audioReady()},t.prototype.errorHandler=function(t){throw this.resourceManager.audioFailed(),new Error("Failed to load audio resource.")},t}();e.Track=o},function(t,e,i){"use strict";var r=i(1),o=i(5),n=function(){function t(t,e,i,n){this.type=r.GeometricEnum.AABB,this.pos=new o.Point(0,0),this.halfWidth=1,this.halfHeight=1,t&&e&&this.pos.set(t,e),i&&(this.halfWidth=i),n&&(this.halfHeight=n)}return t.prototype.setPosition=function(t,e){this.pos.set(t,e)},t}();e.AABB=n},function(t,e,i){"use strict";var r=i(1),o=i(11),n=function(){function t(t,e,i,n){this.type=r.GeometricEnum.BEZIER,this.start=new o.Vector2(0,0),this.end=new o.Vector2(1,0),this.controlStart=new o.Vector2(0,0),this.controlEnd=new o.Vector2(1,0),this.start.set(t,e),this.controlStart.set(t,e),this.end.set(i,n),this.controlEnd.set(i,n)}return t.prototype.getPoint=function(t){var e=new o.Vector2(this.start.x,this.start.y);if(0!==t){var i=1-t,r=t*t,n=i*i,s=n*i,a=r*t;e=this.start.scale(s),e=e.add(this.controlStart.scale(3*n*t)),e=e.add(this.controlEnd.scale(3*i*r)),e=e.add(this.end.scale(a))}return e},t}();e.Bezier=n},function(t,e,i){"use strict";var r=i(1),o=function(){function t(){this.type=r.GeometricEnum.BSPLINE}return t}();e.BSpline=o},function(t,e,i){"use strict";var r=i(1),o=i(5),n=function(){function t(t,e,i){this.type=r.GeometricEnum.CIRCLE,this.pos=new o.Point(0,0),this.radius=1,t&&(this.pos.x=t),e&&(this.pos.y=e),i&&(this.radius=i)}return t.prototype.getType=function(){return this.type},t.prototype.getX=function(){return this.pos.x},t.prototype.getY=function(){return this.pos.y},t.prototype.setX=function(t){this.pos.x=t},t.prototype.setY=function(t){this.pos.y=t},t.prototype.set=function(t,e,i){this.pos.x=t,this.pos.y=e,this.radius=i},t.prototype.get=function(){return this},t.prototype.transform=function(t,e){this.pos.x+=t,this.pos.y+=e},t}();e.Circle=n},function(t,e,i){"use strict";function r(t,e){var i=new s;return i.intersects(t,e)}var o=i(1),n=i(10);e.intersects=r;var s=function(){function t(){}return t.prototype.intersects=function(t,e){switch(t.type){case o.GeometricEnum.POINT:switch(e.type){case o.GeometricEnum.LINE:return this.pointLine();case o.GeometricEnum.CIRCLE:return this.pointCircle(t,e);case o.GeometricEnum.RECTANGLE:return this.pointRectangle(t,e);case o.GeometricEnum.AABB:return this.pointAABB(t,e);case o.GeometricEnum.POLYGON:return this.pointPolygon();default:throw new Error("Second object not a collidable body")}case o.GeometricEnum.LINE:switch(e.type){case o.GeometricEnum.POINT:return this.linePoint();case o.GeometricEnum.CIRCLE:return this.lineCircle();case o.GeometricEnum.RECTANGLE:return this.lineRectangle();case o.GeometricEnum.POLYGON:return this.linePolygon();default:throw new Error("Second object not a collidable body")}case o.GeometricEnum.CIRCLE:switch(e.type){case o.GeometricEnum.CIRCLE:
return this.circleCircle(t,e);case o.GeometricEnum.LINE:return this.circleLine();case o.GeometricEnum.POINT:return this.circlePoint(t,e);case o.GeometricEnum.RECTANGLE:return this.circleRectangle();case o.GeometricEnum.AABB:return this.circleAABB(t,e);case o.GeometricEnum.POLYGON:return this.circlePolygon(t,e);default:throw new Error("Second object not a collidable body")}case o.GeometricEnum.RECTANGLE:switch(e.type){case o.GeometricEnum.RECTANGLE:return this.rectangleRectangle(t,e);case o.GeometricEnum.AABB:return this.rectangleAABB(t,e);case o.GeometricEnum.LINE:return this.rectangleLine();case o.GeometricEnum.CIRCLE:return this.rectangleCircle();case o.GeometricEnum.POINT:return this.rectanglePoint(t,e);case o.GeometricEnum.POLYGON:return this.rectanglePolygon();default:throw new Error("Second object not a collidable body")}case o.GeometricEnum.POLYGON:switch(e.type){case o.GeometricEnum.POLYGON:return this.polygonPolygon();case o.GeometricEnum.LINE:return this.polygonLine();case o.GeometricEnum.CIRCLE:return this.polygonCircle(t,e);case o.GeometricEnum.RECTANGLE:return this.polygonRectangle();case o.GeometricEnum.POINT:return this.polygonPoint();default:throw new Error("Second object not a collidable body")}case o.GeometricEnum.AABB:switch(e.type){case o.GeometricEnum.AABB:return this.aabbAABB(t,e);case o.GeometricEnum.POINT:return this.aabbPoint(t,e);case o.GeometricEnum.CIRCLE:return this.aabbCircle(t,e);case o.GeometricEnum.RECTANGLE:return this.aabbRectangle(t,e)}default:throw new Error("Couldn't find any collider for type")}},t.prototype.pointLine=function(){return!0},t.prototype.linePoint=function(){return!0},t.prototype.pointCircle=function(t,e){var i=new n.Vector2(t.x,t.y),r=new n.Vector2(e.pos.x,e.pos.y),o=r.sub(i).length();return o<e.radius},t.prototype.circlePoint=function(t,e){return this.pointCircle(e,t)},t.prototype.pointRectangle=function(t,e){return t.x>e.pos.x&&t.x<e.pos.x+e.width&&t.y>e.pos.y&&t.y<e.pos.y+e.height},t.prototype.rectanglePoint=function(t,e){return this.pointRectangle(e,t)},t.prototype.pointPolygon=function(){return!0},t.prototype.polygonPoint=function(){return this.pointPolygon()},t.prototype.lineLine=function(){return!0},t.prototype.lineCircle=function(){return!0},t.prototype.circleLine=function(){return this.lineCircle()},t.prototype.lineRectangle=function(){return!0},t.prototype.rectangleLine=function(){return this.lineRectangle()},t.prototype.linePolygon=function(){return!0},t.prototype.polygonLine=function(){return this.linePolygon()},t.prototype.circleCircle=function(t,e){var i=new n.Vector2(t.pos.x,t.pos.y),r=new n.Vector2(e.pos.x,e.pos.y),o=r.sub(i).length(),s=t.radius+e.radius;return o<s},t.prototype.circleRectangle=function(){return!0},t.prototype.rectangleCircle=function(){return this.circleRectangle()},t.prototype.circlePolygon=function(t,e){return!0},t.prototype.polygonCircle=function(t,e){return this.circlePolygon(e,t)},t.prototype.rectangleRectangle=function(t,e){return t.pos.x+t.width>=e.pos.x&&t.pos.y+t.height>=e.pos.y&&t.pos.x<=e.pos.x+e.width&&t.pos.y<=e.pos.y+e.height},t.prototype.rectanglePolygon=function(){return!0},t.prototype.polygonRectangle=function(){return this.rectanglePolygon()},t.prototype.polygonPolygon=function(){return!0},t.prototype.pointAABB=function(t,e){return!(Math.abs(e.pos.x-t.x)>e.halfWidth||Math.abs(e.pos.y-t.y)>e.halfHeight)},t.prototype.aabbPoint=function(t,e){return this.pointAABB(e,t)},t.prototype.circleAABB=function(t,e){return!(Math.abs(e.pos.x-t.pos.x)>e.halfWidth+t.radius||Math.abs(e.pos.y-t.pos.y)>e.halfHeight+t.radius)},t.prototype.aabbCircle=function(t,e){return this.circleAABB(e,t)},t.prototype.rectangleAABB=function(t,e){var i=t.width/2,r=t.height/2;return!(Math.abs(t.pos.x+i-e.pos.x)>i+e.halfWidth||Math.abs(t.pos.y+r-e.pos.y)>r+e.halfHeight)},t.prototype.aabbRectangle=function(t,e){return this.rectangleAABB(e,t)},t.prototype.aabbAABB=function(t,e){return!(Math.abs(t.pos.x-e.pos.x)>t.halfWidth+e.halfWidth||Math.abs(t.pos.y-e.pos.y)>t.halfHeight+e.halfHeight)},t}();e.Collider=s},function(t,e,i){"use strict";var r=i(1),o=i(5),n=function(){function t(t,e,i,n){this.type=r.GeometricEnum.LINE,this.start=new o.Point(-1,0),this.end=new o.Point(1,0),t&&e&&this.start.set(t,e),i&&n&&this.end.set(i,n)}return t.prototype.transform=function(t,e){this.start.transform(t,e),this.end.transform(t,e)},t.prototype.transformStart=function(t,e){this.start.transform(t,e)},t.prototype.transformEnd=function(t,e){this.end.transform(t,e)},t.prototype.set=function(t,e,i,r){this.start.set(t,e),this.end.set(i,r)},t}();e.Line=n},function(t,e,i){"use strict";var r=i(1),o=i(5),n=function(){function t(t){this.type=r.GeometricEnum.POLYGON,this.points=[new o.Point(0,0),new o.Point(1,-1),new o.Point(-1,-1)],this.points=t}return t.prototype.addPoint=function(t){this.points.push(t)},t.prototype.removePoint=function(t){this.points.splice(t,1)},t.prototype.removeFirst=function(){this.points.shift()},t.prototype.removeLast=function(){this.points.pop()},t}();e.Polygon=n},function(t,e,i){"use strict";function r(t,e){var i=new s(t);i.render(e)}var o=i(1),n=i(8);e.render=r;var s=function(){function t(t){this.context=t}return t.prototype.render=function(t){if(!this.context)throw new Error("Renderer must have a context for rendering.");switch(t.type){case o.GeometricEnum.POINT:this.renderPoint(t);break;case o.GeometricEnum.VECTOR2:this.renderPoint(t);break;case o.GeometricEnum.LINE:this.renderLine(t);break;case o.GeometricEnum.AABB:this.renderAABB(t);break;case o.GeometricEnum.RECTANGLE:this.renderRectangle(t);break;case o.GeometricEnum.CIRCLE:this.renderCircle(t);break;default:throw new Error("Not recogniced as a renderable shape.")}},t.prototype.renderPoint=function(t){this.context.beginPath(),this.context.arc(t.x,t.y,1,0,2*n.PI),this.context.fill()},t.prototype.renderLine=function(t){this.context.beginPath(),this.context.moveTo(t.start.x,t.start.y),this.context.lineTo(t.end.x,t.end.x),this.context.stroke()},t.prototype.renderAABB=function(t){this.context.strokeRect(t.pos.x-t.halfWidth,t.pos.y-t.halfHeight,2*t.halfWidth,2*t.halfHeight)},t.prototype.renderRectangle=function(t){this.context.strokeRect(t.pos.x,t.pos.y,t.width,t.height)},t.prototype.renderCircle=function(t){this.context.beginPath(),this.context.arc(t.pos.x,t.pos.y,t.radius,0,2*n.PI),this.context.stroke()},t}();e.Renderer=s},function(t,e,i){"use strict";var r=i(1),o=function(){function t(t,e,i){this.type=r.GeometricEnum.VECTOR3,this.x=0,this.y=0,this.z=0,t&&(this.x=t),e&&(this.y=e),i&&(this.z=i)}return t.prototype.getType=function(){return this.type},t.prototype.getX=function(){return this.x},t.prototype.getY=function(){return this.y},t.prototype.getZ=function(){return this.z},t.prototype.setX=function(t){this.x=t},t.prototype.setY=function(t){this.y=t},t.prototype.setZ=function(t){this.z=t},t.prototype.set=function(t,e,i){this.x=t,this.y=e,this.z=i},t.prototype.get=function(){return this},t.prototype.add=function(e){return new t(this.x+e.x,this.y+e.y,this.z+e.z)},t.prototype.sub=function(e){return new t(this.x-e.x,this.y-e.y,this.z-e.z)},t.prototype.invert=function(){return new t(-this.x,-this.y,-this.z)},t.prototype.scale=function(e){return new t(this.x*e,this.y*e,this.z*e)},t.prototype.normalize=function(){var e=this.length();return 0===e?new t(0,0,0):new t(this.x/e,this.y/e,this.z/e)},t.prototype.project=function(e){var i=this.dot(e),r=this.lengthSquared();return new t(i/r*this.x,i/r*this.y,i/r*this.z)},t.prototype.length=function(){return Math.sqrt(this.lengthSquared())},t.prototype.lengthSquared=function(){return this.x*this.x+this.y*this.y+this.z*this.z},t.prototype.dot=function(t){return this.x*t.x+this.y*t.y+this.z*t.z},t}();e.Vector3=o},function(t,e){"use strict";var i=function(){function t(t,e,i){this.frames=[],this.loop=!1,this.active=!0,this.timePerFrame=100,this.currentFrame=0,this.currentDelta=0,t&&(this.frames=t),e&&(this.loop=e),i&&(this.timePerFrame=i)}return t.prototype.play=function(){this.active=!0},t.prototype.stop=function(){this.active=!1,this.currentFrame=0,this.currentDelta=0},t.prototype.pause=function(){this.active=!1},t.prototype.nextFrame=function(){this.currentFrame+=1,this.currentFrame>=this.frames.length&&(this.loop||(this.active=!1),this.currentFrame=0)},t.prototype.update=function(t){this.active&&(this.currentDelta+=t,this.currentDelta>this.timePerFrame&&(this.currentDelta=0,this.nextFrame()))},t.prototype.render=function(t,e,i){this.frames[this.currentFrame].render(t,e,i)},t.prototype.renderScale=function(t,e,i,r,o){o?this.frames[this.currentFrame].renderScale(t,e,i,r,o):this.frames[this.currentFrame].renderScale(t,e,i,r)},t.prototype.renderAngle=function(t,e,i,r){this.frames[this.currentFrame].renderAngle(t,e,i,r)},t.prototype.renderAngleScale=function(t,e,i,r,o,n){n?this.frames[this.currentFrame].renderAngleScale(t,e,i,r,o,n):this.frames[this.currentFrame].renderAngleScale(t,e,i,r,o)},t}();e.AnimatedSprite=i},function(t,e,i){"use strict";var r=i(2),o=i(3),n=i(6),s="attribute vec2 a_position;\nattribute vec2 a_texCoord;\nvarying vec2 v_texCoord;\nuniform vec2 u_resolution;\nvoid main() {\n\tvec2 zeroToOne = a_position / u_resolution;\n\tvec2 zeroToTwo = zeroToOne * 2.0;\n\tvec2 clipSpace = zeroToTwo - 1.0;\n\tgl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n\tv_texCoord = a_texCoord;\n}\n",a="precision mediump float;\nuniform sampler2D u_image;\nuniform vec4 u_color;\nvarying vec2 v_texCoord;\n\nvoid main() {\n\tvec4 baseTexture = texture2D(u_image, v_texCoord);\n\tgl_FragColor = baseTexture * u_color * u_color.w;\n}\n",h=function(){function t(t){this.color=new o.Color(255,255,255,1),this.width=800,this.height=600,this.renderCalls={},this.gl=t,this.program=new r.Program(this.gl),this.program.loadShader(r.ShaderType.VERTEX,s),this.program.loadShader(r.ShaderType.FRAGMENT,a),this.program.createProgram(),this.init()}return t.prototype.init=function(){var t=this.gl;this.resolution=t.getUniformLocation(this.program.program,"u_resolution"),this.colorLocation=t.getUniformLocation(this.program.program,"u_color"),this.position=t.getAttribLocation(this.program.program,"a_position"),this.textureCoordinates=t.getAttribLocation(this.program.program,"a_texCoord"),this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.texCoordBuffer=t.createBuffer()},t.prototype.setColor=function(t){this.color=t},t.prototype.addCall=function(t){this.renderCalls[t.texture]||(this.renderCalls[t.texture]=new n.RenderCall,this.renderCalls[t.texture].texture=t.texture),this.renderCalls[t.texture].add(t)},t.prototype.clear=function(){this.renderCalls={}},t.prototype.execute=function(){this.flush(),this.clear()},t.prototype.flush=function(){var t=this.gl;t.useProgram(this.program.program),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.uniform2f(this.resolution,this.width,this.height);for(var e in this.renderCalls){t.bindTexture(t.TEXTURE_2D,this.renderCalls[e].texture);var i=this.color.getRGBAFloat();t.uniform4f(this.colorLocation,i[0],i[1],i[2],i[3]),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.renderCalls[e].vertices),t.STATIC_DRAW),t.enableVertexAttribArray(this.position),t.vertexAttribPointer(this.position,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.renderCalls[e].uvs),t.STATIC_DRAW),t.enableVertexAttribArray(this.textureCoordinates),t.vertexAttribPointer(this.textureCoordinates,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.renderCalls[e].indices),t.STATIC_DRAW),t.drawElements(t.TRIANGLES,this.renderCalls[e].numIndices,t.UNSIGNED_SHORT,0)}},t}();e.FontRenderer=h},function(t,e,i){"use strict";var r,o=i(13),n=i(3),s=i(7),a=i(4),h=i(6),c=i(22);!function(t){t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT"}(r||(r={}));var u=function(){function t(t,e){this.texturePage={},this.font=new c.BitmapFont,this.base=0,this.lineHeight=0,this.color=new n.Color(255,255,255,1),this.align=0,this.gl=t,this.http=new s.Http(!1),this.resourceManager=a.ResourceManager.getInstance(),e&&(this.configUrl=e,this.load(e))}return t.prototype.load=function(t){var e=this;this.resourceManager.addOther(),this.http.get(t,function(t){e.parseConfig(t.responseXML)})},t.prototype.parseConfig=function(t){var e=t.getElementsByTagName("page"),i=t.getElementsByTagName("char"),r=t.getElementsByTagName("common")[0],n=t.getElementsByTagName("info")[0];this.font.glyphCount=+t.getElementsByTagName("chars")[0].getAttribute("count"),this.font.info={face:n.getAttribute("face"),size:+n.getAttribute("size"),italic:+n.getAttribute("italic"),charset:n.getAttribute("charset"),unicode:+n.getAttribute("unicode"),bold:+n.getAttribute("bold"),stretchHeight:+n.getAttribute("stretchH"),smooth:+n.getAttribute("smooth"),antiAliasing:+n.getAttribute("aa"),padding:n.getAttribute("padding").split(",").map(function(t){return+t}),spacing:n.getAttribute("spacing").split(",").map(function(t){return+t}),outline:+n.getAttribute("outline")},this.font.common={lineHeight:+r.getAttribute("lineHeight"),base:+r.getAttribute("base"),scaleWidth:+r.getAttribute("scaleW"),scaleHeight:+r.getAttribute("scaleH"),pages:+r.getAttribute("pages"),packed:+r.getAttribute("packed"),alphaChannel:+r.getAttribute("alphaChnl"),redChannel:+r.getAttribute("redChnl"),greenChannel:+r.getAttribute("greenChnl"),blueChannel:+r.getAttribute("blueChnl")};for(var s=0;s<e.length;s+=1){var a=e[s].getAttribute("file"),h=+e[s].getAttribute("id");this.font.pages[h]={file:a},this.texturePage[h]=new o.Texture(this.gl,a)}for(var s=0;s<i.length;s+=1){var h=+i[s].getAttribute("id");this.font.glyphs[h]={x:+i[s].getAttribute("x"),y:+i[s].getAttribute("y"),width:+i[s].getAttribute("width"),height:+i[s].getAttribute("height"),xOffset:+i[s].getAttribute("xoffset"),yOffset:+i[s].getAttribute("yoffset"),xAdvance:+i[s].getAttribute("xadvance"),page:+i[s].getAttribute("page"),channel:+i[s].getAttribute("chnl")}}this.resourceManager.otherReady()},t.prototype.drawString=function(t,e,i,r){var o=i;if(1===this.align){var n=this.calculateWidth(e);o=i-Math.floor(n/2)}else if(2===this.align){var n=this.calculateWidth(e);o=i-n}for(var s=0;s<e.length;s+=1){var a=e.charCodeAt(s);if(this.font.glyphs[a]){var h=this.font.glyphs[a];this.renderGlyph(t,o+h.xOffset,r+h.yOffset,h),o+=h.xAdvance}}},t.prototype.renderGlyph=function(t,e,i,r){var o=[];o[0]=r.x/this.font.common.scaleWidth,o[1]=r.y/this.font.common.scaleHeight,o[2]=(r.x+r.width)/this.font.common.scaleWidth,o[3]=(r.y+r.height)/this.font.common.scaleHeight;var n=new h.RenderCall;n.texture=this.texturePage[r.page].texture,n.vertices=[e,i,e+r.width,i,e,i+r.height,e+r.width,i+r.height],n.uvs=[o[0],o[1],o[2],o[1],o[0],o[3],o[2],o[3]],n.indices=[0,1,2,1,2,3],n.numIndices=6,t.addCall(n)},t.prototype.calculateWidth=function(t){for(var e=0,i=0;i<t.length;i+=1){var r=t.charCodeAt(i);e+=+this.font.glyphs[r].xAdvance}return e},t}();e.Font=u},function(t,e,i){"use strict";var r=i(51);e.Font=r.Font;var o=i(22);e.BitmapFont=o.BitmapFont;var n=i(50);e.FontRenderer=n.FontRenderer},function(t,e,i){"use strict";var r=i(2),o=i(12),n="attribute vec2 a_position;\nattribute vec2 a_texCoord;\nvarying vec2 v_texCoord;\nuniform vec2 u_resolution;\nvoid main() {\n\tvec2 zeroToOne = a_position / u_resolution;\n\tvec2 zeroToTwo = zeroToOne * 2.0;\n\tvec2 clipSpace = zeroToTwo - 1.0;\n\tgl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n\tv_texCoord = a_texCoord;\n}\n",s="precision mediump float;\nuniform float u_blend_mode;\nuniform sampler2D u_scene_texture;\nuniform sampler2D u_glow_texture;\nvarying vec2 v_texCoord;\nconst float ADDITIVE_BLENDING = 1.0;\nconst float SCREEN_BLENDING   = 2.0;\nvoid main() {\n\tvec4 dst = texture2D(u_scene_texture, v_texCoord); // Rendered scene (tmu:0)\n\tvec4 src = texture2D(u_glow_texture,  v_texCoord); // Glow map       (tmu:1)\n\tif (u_blend_mode == ADDITIVE_BLENDING) {\n\t\t// Additive blending (strong result, high overexposure).\n\t\tgl_FragColor = min(src + dst, 1.0);\n\t} else if (u_blend_mode == SCREEN_BLENDING) {\n\t\t// Screen blending (mild result, medium overexposure).\n\t\tgl_FragColor = clamp((src + dst) - (src * dst), 0.0, 1.0);\n\t} else {\n\t\t// Show the glow map instead (DISPLAY_GLOWMAP).\n\t\tgl_FragColor = src;\n\t}\n}",a=function(){function t(t,e,i){this.gl=t,this.width=e,this.height=i,this.combinationProgram=new r.Program(this.gl),this.combinationProgram.loadShader(r.ShaderType.VERTEX,n),this.combinationProgram.loadShader(r.ShaderType.FRAGMENT,s),this.combinationProgram.createProgram(),this.init()}return t.prototype.init=function(){var t=this.gl;this.glowFramebuffer=new o.FrameBuffer(t,this.width,this.height),this.blendMode=t.getUniformLocation(this.combinationProgram.program,"u_blend_mode"),this.resolution=t.getUniformLocation(this.combinationProgram.program,"u_resolution"),this.position=t.getAttribLocation(this.combinationProgram.program,"a_position"),this.textureCoordinates=t.getAttribLocation(this.combinationProgram.program,"a_texCoord"),this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.texCoordBuffer=t.createBuffer()},t.prototype.execute=function(t,e){var i=this.gl;return i.bindFramebuffer(i.FRAMEBUFFER,this.glowFramebuffer.fbo),this.render(e,t),i.bindFramebuffer(i.FRAMEBUFFER,null),this.glowFramebuffer.texture},t.prototype.render=function(t,e){var i=this.gl,r=[0,0,this.width,0,0,this.height,this.width,this.height],o=[0,0,1,0,0,1,1,1],n=[0,1,2,1,2,3],s=6;i.useProgram(this.combinationProgram.program),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.uniform2f(this.resolution,800,600),i.uniform1f(this.blendMode,1),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,t),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,e),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(r),i.STATIC_DRAW),i.enableVertexAttribArray(this.position),i.vertexAttribPointer(this.position,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,this.texCoordBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(o),i.STATIC_DRAW),i.enableVertexAttribArray(this.textureCoordinates),i.vertexAttribPointer(this.textureCoordinates,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),i.STATIC_DRAW),i.drawElements(i.TRIANGLES,s,i.UNSIGNED_SHORT,0),i.bindTexture(i.TEXTURE_2D,e),i.activeTexture(i.TEXTURE0)},t}();e.Bloom=a},function(t,e,i){"use strict";var r=i(2),o=i(12),n="attribute vec2 a_position;\nattribute vec2 a_texCoord;\nvarying vec2 v_texCoord;\nuniform vec2 u_resolution;\nvoid main() {\n\tvec2 zeroToOne = a_position / u_resolution;\n\tvec2 zeroToTwo = zeroToOne * 2.0;\n\tvec2 clipSpace = zeroToTwo - 1.0;\n\tgl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n\tv_texCoord = a_texCoord;\n}\n",s="precision mediump float;\nuniform vec2  u_texel_size;\nuniform float u_blur_amount;\nuniform float u_blur_scale;\nuniform float u_blur_strength;\nuniform int u_horizontal;\nuniform sampler2D u_color_texture;\nvarying vec2 v_texCoord;\nconst float BLUR_PASSES = 20.0;\nfloat gaussian(float x, float deviation) {\n\treturn (1.0 / sqrt(6.28318530718 * deviation)) * exp(-((x * x) / (2.0 * deviation)));\n}\nvoid main() {\n\tvec4  color = vec4(0.0);\n\tfloat half_blur = u_blur_amount * 0.5;\n\tfloat strength = 1.0 - u_blur_strength;\n\tfloat deviation = half_blur * 0.35;\n\tdeviation *= deviation;\n   if (u_horizontal == 1) {\n\t    for (float i = 0.0; i < BLUR_PASSES; i += 1.0) {\n\t\t    float offset = i - half_blur;\n\t\t    vec4 tex_color = texture2D(u_color_texture, v_texCoord +\n\t\t\t    vec2(offset * u_texel_size.x * u_blur_scale, 0.0)) * gaussian(offset * strength, deviation);\n\t\t    color += tex_color;\n\t    }\n   } else {\n       for (float i = 0.0; i < BLUR_PASSES; i += 1.0) {\n            float offset = i - half_blur;\n            vec4 tex_color = texture2D(u_color_texture, v_texCoord +\n                vec2(0.0, offset * u_texel_size.y * u_blur_scale)) * gaussian(offset * strength, deviation);\n            color += tex_color;\n        }\n   }\n\tgl_FragColor = clamp(color, 0.0, 1.0);\n}",a=function(){function t(t,e,i){this.gl=t,this.width=e,this.height=i,this.blurProgram=new r.Program(this.gl),this.blurProgram.loadShader(r.ShaderType.VERTEX,n),this.blurProgram.loadShader(r.ShaderType.FRAGMENT,s),this.blurProgram.createProgram(),this.init()}return t.prototype.init=function(){var t=this.gl;this.horizontalFBO=new o.FrameBuffer(t,this.width,this.height),this.verticalFBO=new o.FrameBuffer(t,this.width,this.height),this.texelSize=t.getUniformLocation(this.blurProgram.program,"u_texel_size"),this.blurAmount=t.getUniformLocation(this.blurProgram.program,"u_blur_amount"),this.blurScale=t.getUniformLocation(this.blurProgram.program,"u_blur_scale"),this.blurStrength=t.getUniformLocation(this.blurProgram.program,"u_blur_strength"),this.horizontal=t.getUniformLocation(this.blurProgram.program,"u_horizontal"),this.resolution=t.getUniformLocation(this.blurProgram.program,"u_resolution"),this.position=t.getAttribLocation(this.blurProgram.program,"a_position"),this.textureCoordinates=t.getAttribLocation(this.blurProgram.program,"a_texCoord"),this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.texCoordBuffer=t.createBuffer()},t.prototype.execute=function(t){var e=this.gl;return e.bindFramebuffer(e.FRAMEBUFFER,this.horizontalFBO.fbo),this.render(!0,t),e.bindFramebuffer(e.FRAMEBUFFER,this.verticalFBO.fbo),this.render(!1,this.horizontalFBO.texture),e.bindFramebuffer(e.FRAMEBUFFER,null),this.verticalFBO.texture},t.prototype.render=function(t,e){var i=this.gl,r=[0,0,this.width,0,0,this.height,this.width,this.height],o=[0,0,1,0,0,1,1,1],n=[0,1,2,1,2,3],s=6;i.useProgram(this.blurProgram.program),i.blendFunc(i.SRC_ALPHA,i.ONE_MINUS_SRC_ALPHA),i.uniform2f(this.resolution,800,600),i.uniform2fv(this.texelSize,[1/this.width,1/this.height]),i.uniform1f(this.blurAmount,35),i.uniform1f(this.blurScale,1),i.uniform1f(this.blurStrength,.2),t?i.uniform1i(this.horizontal,1):i.uniform1i(this.horizontal,0),i.bindTexture(i.TEXTURE_2D,e),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(r),i.STATIC_DRAW),i.enableVertexAttribArray(this.position),i.vertexAttribPointer(this.position,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,this.texCoordBuffer),i.bufferData(i.ARRAY_BUFFER,new Float32Array(o),i.STATIC_DRAW),i.enableVertexAttribArray(this.textureCoordinates),i.vertexAttribPointer(this.textureCoordinates,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,new Uint16Array(n),i.STATIC_DRAW),i.drawElements(i.TRIANGLES,s,i.UNSIGNED_SHORT,0)},t}();e.Blur=a},function(t,e,i){"use strict";var r=i(54);e.Blur=r.Blur;var o=i(53);e.Bloom=o.Bloom},function(t,e,i){"use strict";var r=i(61);e.Render2d=r;var o=i(63);e.Shader=o;var n=i(57);e.Particle=n;var s=i(52);e.Font=s;var a=i(66);e.Tilemap=a;var h=i(55);e.FX=h;var c=i(13);e.Texture=c.Texture;var u=i(65);e.Sprite=u.Sprite;var l=i(49);e.AnimatedSprite=l.AnimatedSprite},function(t,e,i){"use strict";var r=i(23);e.Particle=r.Particle;var o=i(58);e.ParticleEmitter=o.ParticleEmitter;var n=i(60);e.ParticleSystem=n.ParticleSystem;var s=i(59);e.ParticleRenderer=s.ParticleRenderer},function(t,e,i){"use strict";var r=i(23),o=i(10),n=i(3),s=i(7),a=function(){function t(t){this.particles=[],this.vertices=[],this.sizes=[],this.constant=!1,this.color=new n.Color(240,175,25,.4),this.gl=t,this.blendSrc=t.SRC_ALPHA,this.blendDst=t.ONE,this.http=new s.Http(!1)}return t.prototype.setup=function(t,e,i,r,o,n,s,a,h,c,u,l,p,d,f,g,m,y,v){this.texture=t,this.pos=e,this.maxDir=i,this.minDir=r,this.maxVel=o,this.minVel=n,this.maxSize=s,this.minSize=a,this.maxLife=h,this.minLife=c,this.growth=u,this.gravity=l,this.wind=p,this.angularVel=d,this.lifeCycle=f,this.particlesPerSecond=g,this.particlesAtStart=m,this.constant=y,this.color=v},t.prototype.load=function(t){this.http.get(t,function(t){JSON.parse(t.responseText)})},t.prototype.toJson=function(){return""},t.prototype.update=function(t){if(this.vertices=[],this.sizes=[],this.constant)for(var e=Math.ceil(t/1e3*this.particlesPerSecond),i=0;i<e;i+=1)this.particles.push(this.addParticle());else if(this.currentLife-=t,this.currentLife<0){for(var i=0;i<this.particlesAtStart;i+=1)this.particles.push(this.addParticle());this.currentLife=this.lifeCycle}for(var r=this.particles.length,i=0;i<r;i+=1)this.particles[i].update(this.gravity,this.wind,this.growth,t),this.particles[i].isDead()?(this.particles.splice(i,1),r-=1):(this.vertices.push(this.particles[i].pos.x),this.vertices.push(this.particles[i].pos.y),this.sizes.push(this.particles[i].size))},t.prototype.addParticle=function(){return new r.Particle(new o.Point(this.pos.x,this.pos.y),new o.Point(this.randomMinMax(this.minDir.x,this.maxDir.x),this.randomMinMax(this.minDir.y,this.maxDir.y)),this.randomMinMax(this.minSize,this.maxSize),this.randomMinMax(this.minVel,this.maxVel),this.randomMinMax(this.minLife,this.maxLife),this.color.getAlpha())},t.prototype.randomMinMax=function(t,e){return Math.random()*(e-t)+t},t}();e.ParticleEmitter=a},function(t,e,i){"use strict";var r=i(2),o="attribute vec2 a_position;\nattribute float a_pointSize;\nuniform vec2 u_resolution;\nvoid main() {\n\tvec2 zeroToOne = a_position / u_resolution;\n\tvec2 zeroToTwo = zeroToOne * 2.0;\n\tvec2 clipSpace = zeroToTwo - 1.0;\n\tgl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n\tgl_PointSize = a_pointSize;\n}\n",n="precision mediump float;\nuniform sampler2D u_image;\nuniform vec4 u_color;\nvoid main() {\n\tvec4 baseTexture = texture2D(u_image, gl_PointCoord);\n\tvec4 baseColor = u_color;\n\tfloat alpha = u_color.w;\n\tgl_FragColor = baseTexture * u_color;\n}\n",s=function(){function t(t){this.width=800,this.height=600,this.gl=t,this.program=new r.Program(this.gl),this.program.loadShader(r.ShaderType.VERTEX,o),this.program.loadShader(r.ShaderType.FRAGMENT,n),this.program.createProgram(),this.init()}return t.prototype.init=function(){var t=this.gl;this.resolution=t.getUniformLocation(this.program.program,"u_resolution"),this.colorLocation=t.getUniformLocation(this.program.program,"u_color"),this.pointSize=t.getAttribLocation(this.program.program,"a_pointSize"),this.position=t.getAttribLocation(this.program.program,"a_position"),this.vertexBuffer=t.createBuffer(),this.sizeBuffer=t.createBuffer()},t.prototype.render=function(t){var e=this.gl;e.useProgram(this.program.program),e.enable(e.BLEND),e.blendFunc(t.blendSrc,t.blendDst),e.uniform2f(this.resolution,this.width,this.height),e.bindTexture(e.TEXTURE_2D,t.texture.texture);var i=t.color.getRGBAFloat();e.uniform4f(this.colorLocation,i[0],i[1],i[2],i[3]),e.bindBuffer(e.ARRAY_BUFFER,this.vertexBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t.vertices),e.STATIC_DRAW),e.enableVertexAttribArray(this.position),e.vertexAttribPointer(this.position,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,this.sizeBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array(t.sizes),e.STATIC_DRAW),e.enableVertexAttribArray(this.pointSize),e.vertexAttribPointer(this.pointSize,1,e.FLOAT,!1,0,0),e.drawArrays(e.POINTS,0,t.vertices.length/2),e.disableVertexAttribArray(this.position),e.disableVertexAttribArray(this.pointSize)},t}();e.ParticleRenderer=s},function(t,e){"use strict";var i=function(){function t(){}return t}();e.ParticleSystem=i},function(t,e,i){"use strict";var r=i(62);e.Renderer2d=r.Renderer2d;var o=i(6);e.RenderCall=o.RenderCall;var n=i(12);e.FrameBuffer=n.FrameBuffer},function(t,e,i){"use strict";var r=i(2),o=i(6),n="attribute vec2 a_position;\nattribute vec2 a_texCoord;\nvarying vec2 v_texCoord;\nuniform vec2 u_resolution;\nuniform int u_flip;\nvoid main() {\n\tvec2 zeroToOne = a_position / u_resolution;\n\tvec2 zeroToTwo = zeroToOne * 2.0;\n\tvec2 clipSpace = zeroToTwo - 1.0;\n   if (u_flip == 1) {\n       gl_Position = vec4(clipSpace * vec2(1, 1), 0, 1);\n\t} else {\n       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n   }\n\tv_texCoord = a_texCoord;\n}\n",s="precision mediump float;\nuniform sampler2D u_image;\nvarying vec2 v_texCoord;\n\nvoid main() {\n\tvec4 baseTexture = texture2D(u_image, v_texCoord);\n\tgl_FragColor = baseTexture;\n}\n",a=function(){function t(t){this.width=800,this.height=600,this.flipY=0,this.renderCalls=[],this.gl=t,this.program=new r.Program(this.gl),this.program.loadShader(r.ShaderType.VERTEX,n),this.program.loadShader(r.ShaderType.FRAGMENT,s),this.program.createProgram(),this.init()}return t.prototype.init=function(){var t=this.gl;this.resolution=t.getUniformLocation(this.program.program,"u_resolution"),this.flip=t.getUniformLocation(this.program.program,"u_flip"),this.position=t.getAttribLocation(this.program.program,"a_position"),this.textureCoordinates=t.getAttribLocation(this.program.program,"a_texCoord"),this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.texCoordBuffer=t.createBuffer()},t.prototype.addCall=function(t){var e=!1;for(var i in this.renderCalls)if(this.renderCalls[i].texture===t.texture){this.renderCalls[i].add(t),e=!0;break}if(!e){this.renderCalls.push(new o.RenderCall);var i=this.renderCalls.length-1;this.renderCalls[i].texture=t.texture,this.renderCalls[i].add(t)}},t.prototype.clear=function(){this.renderCalls=[]},t.prototype.execute=function(){this.flush(),this.clear()},t.prototype.flush=function(){var t=this.gl;t.useProgram(this.program.program),t.blendFunc(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA),t.cullFace(t.FRONT_AND_BACK),t.uniform2f(this.resolution,this.width,this.height),t.uniform1i(this.flip,this.flipY);for(var e in this.renderCalls)t.bindTexture(t.TEXTURE_2D,this.renderCalls[e].texture),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.renderCalls[e].vertices),t.STATIC_DRAW),t.enableVertexAttribArray(this.position),t.vertexAttribPointer(this.position,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.texCoordBuffer),t.bufferData(t.ARRAY_BUFFER,new Float32Array(this.renderCalls[e].uvs),t.STATIC_DRAW),t.enableVertexAttribArray(this.textureCoordinates),t.vertexAttribPointer(this.textureCoordinates,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.renderCalls[e].indices),t.STATIC_DRAW),t.drawElements(t.TRIANGLES,this.renderCalls[e].numIndices,t.UNSIGNED_SHORT,0)},t}();e.Renderer2d=a},function(t,e,i){"use strict";var r=i(2);e.Program=r.Program;var o=i(64);e.ShaderManager=o.ShaderManager},function(t,e,i){"use strict";var r=i(2),o=function(){function t(t){this.programs={},this.gl=t}return t.prototype.createProgram=function(t,e,i){this.programs[i]=new r.Program(this.gl,t,e)},t.prototype.getProgram=function(t){return this.programs[t].getProgram()},t.prototype.useProgram=function(t){this.gl.useProgram(this.programs[t].getProgram())},t}();e.ShaderManager=o},function(t,e,i){"use strict";var r=i(6),o=i(11),n=i(31),s=function(){function t(t,e,i,r){t&&(this.texture=t),e&&i&&(this.width=e,this.height=i),r&&this.setUVByPixels(r[0],r[1],r[2],r[3])}return t.prototype.setUV=function(t,e,i,r){this.uv=[t,e,i,r]},t.prototype.setUVByPixels=function(t,e,i,r){this.uv=[t/this.texture.width,e/this.texture.height,(t+i)/this.texture.width,(e+r)/this.texture.height]},t.prototype.render=function(t,e,i){var o=new r.RenderCall;o.texture=this.texture.texture,o.vertices=[e,i,e+this.width,i,e,i+this.height,e+this.width,i+this.height],o.uvs=[this.uv[0],this.uv[1],this.uv[2],this.uv[1],this.uv[0],this.uv[3],this.uv[2],this.uv[3]],o.indices=[0,1,2,1,2,3],o.numIndices=6,t.addCall(o)},t.prototype.renderScale=function(t,e,i,o,n){var s=new r.RenderCall;n?s.vertices=[e,i,e+this.width*n,i,e,i+this.height*o,e+this.width*n,i+this.height*o]:s.vertices=[e,i,e+this.width*o,i,e,i+this.height*o,e+this.width*o,i+this.height*o],s.texture=this.texture.texture,s.uvs=[this.uv[0],this.uv[1],this.uv[2],this.uv[1],this.uv[0],this.uv[3],this.uv[2],this.uv[3]],
s.indices=[0,1,2,1,2,3],s.numIndices=6,t.addCall(s)},t.prototype.renderAngle=function(t,e,i,s){var a=[],h=e+this.width/2,c=i+this.height/2;a[0]=new o.Vector2(e,i),a[1]=new o.Vector2(e+this.width,i),a[2]=new o.Vector2(e,i+this.height),a[3]=new o.Vector2(e+this.width,i+this.height);for(var u in a)a[u]=a[u].rotatePivot(h,c,n.degreeToRadian(s));var l=new r.RenderCall;l.texture=this.texture.texture,l.vertices=[a[0].x,a[0].y,a[1].x,a[1].y,a[2].x,a[2].y,a[3].x,a[3].y],l.uvs=[this.uv[0],this.uv[1],this.uv[2],this.uv[1],this.uv[0],this.uv[3],this.uv[2],this.uv[3]],l.indices=[0,1,2,1,2,3],l.numIndices=6,t.addCall(l)},t.prototype.renderAngleScale=function(t,e,i,s,a,h){var c=[],u=e+this.width*a/2,l=i+this.height*a/2;h?(c[0]=new o.Vector2(e,i),c[1]=new o.Vector2(e+this.width*a,i),c[2]=new o.Vector2(e,i+this.height*h),c[3]=new o.Vector2(e+this.width*a,i+this.height*h)):(c[0]=new o.Vector2(e,i),c[1]=new o.Vector2(e+this.width*a,i),c[2]=new o.Vector2(e,i+this.height*a),c[3]=new o.Vector2(e+this.width*a,i+this.height*a));for(var p in c)c[p]=c[p].rotatePivot(u,l,n.degreeToRadian(s));var d=new r.RenderCall;d.texture=this.texture.texture,d.vertices=[c[0].x,c[0].y,c[1].x,c[1].y,c[2].x,c[2].y,c[3].x,c[3].y],d.uvs=[this.uv[0],this.uv[1],this.uv[2],this.uv[1],this.uv[0],this.uv[3],this.uv[2],this.uv[3]],d.indices=[0,1,2,1,2,3],d.numIndices=6,t.addCall(d)},t.prototype.renderFBO=function(t){var e=new r.RenderCall;e.texture=this.texture.texture,e.vertices=[0,this.height,this.width,this.height,0,0,this.width,0],e.uvs=[this.uv[0],this.uv[1],this.uv[2],this.uv[1],this.uv[0],this.uv[3],this.uv[2],this.uv[3]],e.indices=[0,1,2,1,2,3],e.numIndices=6,t.addCall(e)},t}();e.Sprite=s},function(t,e,i){"use strict";var r=i(68);e.Tilemap=r.Tilemap;var o=i(24);e.TilemapLayer=o.TilemapLayer;var n=i(25);e.Tileset=n.Tileset;var s=i(67);e.Tile=s.Tile},function(t,e){"use strict";var i=function(){function t(){}return t}();e.Tile=i},function(t,e,i){"use strict";var r=i(24),o=i(25),n=i(3),s=i(7),a=i(4),h=i(21),c=function(){function t(t){this.layers=[],this.tilesets=[],this.backgroundColor=new n.Color(100,100,100,1),this.ready=!1,this.activeLayer=0,t&&(this.gl=t),this.resourceManager=a.ResourceManager.getInstance(),this.http=new s.Http(!1)}return t.prototype.loadTiledMap=function(t){var e=this;this.resourceManager.addOther(),this.http.get(t,function(t){e.parseTiledMap(t.responseText)})},t.prototype.parseTiledMap=function(t){var e=JSON.parse(t);this.width=e.width,this.height=e.height,this.tileWidth=e.tilewidth,this.tileHeight=e.tileheight,this.orientation=e.orientation,this.renderOrder=e.renderorder,this.nextObjectId=e.nextobjectid,e.backgroundcolor&&this.backgroundColor.setHex(e.backgroundcolor);for(var i=0,n=e.layers;i<n.length;i++){var s=n[i];this.layers.push(new r.TilemapLayer(s.data,s.encoding,s.width,s.height,s.x,s.y,s.opacity,s.visible,s.name,s.type))}for(var a=0,h=e.tilesets;a<h.length;a++){var c=h[a];this.tilesets.push(new o.Tileset(this.gl,c.name,c.image,c.imagewidth,c.imageheight,c.firstgid,c.margin,c.spacing,c.columns,c.tilecount,c.tilewidth,c.tileheight))}this.resourceManager.otherReady()},t.prototype.setActiveLayer=function(t){this.activeLayer=t},t.prototype.getActiveLayer=function(){return this.activeLayer},t.prototype.getContainedTiles=function(t,e){var i=[];return i},t.prototype.getTileAt=function(t,e,i){var r={id:0};if(i){var o=Math.floor(e/(this.tileHeight*i)),n=Math.floor(t/(this.tileWidth*i)),s=o*this.width+n,a=this.layers[this.activeLayer].getTile(s);r.id=a.tileid,r.row=a.row,r.col=a.col,r.collider=new h.Rectangle(this.tileWidth*i*n,this.tileHeight*i*o,this.tileWidth*i,this.tileHeight*i)}else{var o=Math.floor(e/this.tileHeight),n=Math.floor(t/this.tileWidth),s=o*this.width+n,a=this.layers[this.activeLayer].getTile(s);console.log(n,o,s),r.id=a.tileid,r.row=a.row,r.col=a.col,r.collider=new h.Rectangle(this.tileWidth*n,this.tileHeight*o,this.tileWidth,this.tileHeight)}return r},t.prototype.render=function(t,e,i,r,o){for(var n=0,s=this.layers;n<s.length;n++){var a=s[n];if(a.isVisible())for(var h in a.tiles){var c=a.getTile(+h),u=this.tileWidth*c.col+e,l=this.tileHeight*c.row+i;if(0!==c.tileid)for(var p in this.tilesets)if(c.tileid>=this.tilesets[p].firstgid&&c.tileid<=this.tilesets[p].lastgid){this.tilesets[p].renderTile(t,u,l,c.tileid);break}}}},t.prototype.renderScale=function(t,e,i,r){for(var o=0,n=this.layers;o<n.length;o++){var s=n[o];if(s.isVisible())for(var a in s.tiles){var h=s.getTile(+a),c=this.tileWidth*r*h.col+e,u=this.tileHeight*r*h.row+i;if(0!==h.tileid)for(var l in this.tilesets)if(h.tileid>=this.tilesets[l].firstgid&&h.tileid<=this.tilesets[l].lastgid){this.tilesets[l].renderTileScale(t,c,u,h.tileid,r);break}}}},t}();e.Tilemap=c},function(t,e,i){"use strict";var r=i(3);e.Color=r.Color;var o=i(27);e.Surface2d=o.Surface2d;var n=i(28);e.Surface3d=n.Surface3d;var s=i(70);e.Sprite=s.Sprite},function(t,e){"use strict";var i=function(){function t(t){this.loaded=!1,t&&(this.url=t,this.load(this.url))}return t.prototype.load=function(t){var e=this;this.image=new Image,this.image.src=t,this.image.addEventListener("load",function(t){e.loadHandler(t)}),this.image.addEventListener("error",e.errorHandler)},t.prototype.render=function(t,e,i){t.drawImage(this.image,e,i)},t.prototype.renderSize=function(t,e,i,r,o){t.drawImage(this.image,e,i,r,o)},t.prototype.renderSegment=function(t,e,i,r,o,n,s){t.drawImage(this.image,r,o,n,s,e,i,this.width,this.height)},t.prototype.renderSegmentSize=function(t,e,i,r,o,n,s,a,h){t.drawImage(this.image,n,s,a,h,e,i,r,o)},t.prototype.errorHandler=function(t){throw new Error("Failed to load sprite.")},t.prototype.loadHandler=function(t){this.loaded=!0,this.width=this.image.width,this.height=this.image.height},t}();e.Sprite=i},function(t,e){"use strict";var i=function(){function t(){this.index=0,this.connected=!1;var e=this;if(t.instance)throw new Error("Error: Instantiation failed, Use Mouse.getInstance() instead of new.");t.instance=this;var i=navigator.getGamepads();i[0]&&i[0].connected&&(this.connected=!0),window.addEventListener("gamepadconnected",function(t){console.log("Connecting gamepad "+t.gamepad.id),e.setupController(t)})}return t.getInstance=function(){return t.instance},t.prototype.setupController=function(t){this.buttons=t.gamepad.buttons,this.axes=t.gamepad.axes,this.id=t.gamepad.id,this.index=t.gamepad.index,this.mapping=t.gamepad.mapping,this.connected=t.gamepad.connected},t.prototype.update=function(t){var e=navigator.getGamepads()[this.index];this.buttons=e.buttons,this.axes=e.axes},t.instance=new t,t}();e.Controller=i},function(t,e,i){"use strict";var r=i(74);e.Mouse=r.Mouse;var o=i(73);e.Keyboard=o.Keyboard,e.Key=o.Key;var n=i(75);e.Touch=n.Touch;var s=i(71);e.Controller=s.Controller},function(t,e){"use strict";!function(t){t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.ENTER=13]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CTRL=17]="CTRL",t[t.ALT=18]="ALT",t[t.PAUSE=19]="PAUSE",t[t.CAPS=20]="CAPS",t[t.ESCAPE=27]="ESCAPE",t[t.PAGEUP=33]="PAGEUP",t[t.PAGEDOWN=34]="PAGEDOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.ZERO=48]="ZERO",t[t.ONE=49]="ONE",t[t.TWO=50]="TWO",t[t.THREE=51]="THREE",t[t.FOUR=52]="FOUR",t[t.FIVE=53]="FIVE",t[t.SIX=54]="SIX",t[t.SEVEN=55]="SEVEN",t[t.EIGHT=56]="EIGHT",t[t.NINE=57]="NINE",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.Y=88]="Y",t[t.X=89]="X",t[t.Z=90]="Z",t[t.LEFTSUPER=91]="LEFTSUPER",t[t.RIGHTSUPER=92]="RIGHTSUPER",t[t.SELECT=93]="SELECT",t[t.NUM0=96]="NUM0",t[t.NUM1=97]="NUM1",t[t.NUM2=98]="NUM2",t[t.NUM3=99]="NUM3",t[t.NUM4=100]="NUM4",t[t.NUM5=101]="NUM5",t[t.NUM6=102]="NUM6",t[t.NUM7=103]="NUM7",t[t.NUM8=104]="NUM8",t[t.NUM9=105]="NUM9",t[t.MULTIPLY=106]="MULTIPLY",t[t.ADD=107]="ADD",t[t.SUBSTRACT=108]="SUBSTRACT",t[t.DECIMAL=110]="DECIMAL",t[t.DIVIDE=111]="DIVIDE",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NUMLOCK=144]="NUMLOCK",t[t.SCROLLLOCK=145]="SCROLLLOCK",t[t.SEMICOLON=186]="SEMICOLON",t[t.EQUAL=187]="EQUAL",t[t.COMMA=188]="COMMA",t[t.DASH=189]="DASH",t[t.PERIOD=190]="PERIOD",t[t.FORWARDSLASH=191]="FORWARDSLASH",t[t.GRAVEACCENT=192]="GRAVEACCENT",t[t.OPENBRACKET=219]="OPENBRACKET",t[t.BACKSLASH=220]="BACKSLASH",t[t.CLOSEBRAKET=221]="CLOSEBRAKET",t[t.SINGLEQUOTE=222]="SINGLEQUOTE"}(e.Key||(e.Key={}));var i=(e.Key,function(){function t(){if(this.keys=[],this.preventDefault=!1,this.stopPropagation=!1,this.keyLogger=!1,t.instance)throw new Error("Error: Instantiation failed, Use Keyboard.getInstance() instead of new.");t.instance=this;for(var e=this,i=0;i<256;i++)this.keys[i]=!1;window.addEventListener("keydown",function(t){e.handleKeydown(t)}),window.addEventListener("keyup",function(t){e.handleKeyup(t)})}return t.getInstance=function(){return t.instance},t.prototype.clearKeys=function(){for(var t in this.keys)this.keys[t]=!1},t.prototype.handleKeydown=function(t){this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation(),this.keys[t.keyCode]=!0},t.prototype.handleKeyup=function(t){this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation(),this.keys[t.keyCode]=!1},t.instance=new t,t}());e.Keyboard=i},function(t,e,i){"use strict";var r=i(20),o=function(){function t(){if(this.stopPropagation=!1,this.preventDefault=!1,t.instance)throw new Error("Error: Instantiation failed, Use Mouse.getInstance() instead of new.");t.instance=this,this.button=[!1,!1,!1],this.click=[!1,!1,!1]}return t.prototype.init=function(){var t=this;this.container=document.getElementById(r.CONTAINER_ID),this.container.addEventListener("click",function(e){t.handleClick(e)}),this.container.addEventListener("mousemove",function(e){t.calculateMousePosition(e)}),this.container.addEventListener("mousedown",function(e){t.handleMouseDown(e)}),this.container.addEventListener("mouseup",function(e){t.handleMouseUp(e)})},t.getInstance=function(){return t.instance},t.prototype.clearClicks=function(){this.click=[!1,!1,!1]},t.prototype.handleClick=function(t){this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation(),this.click[t.button]=!0},t.prototype.handleMouseDown=function(t){this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation(),this.button[t.button]=!0},t.prototype.handleMouseUp=function(t){this.preventDefault&&t.preventDefault(),this.stopPropagation&&t.stopPropagation(),this.button[t.button]=!1},t.prototype.calculateMousePosition=function(t){t.pageX&&t.pageY?(this.x=t.pageX,this.y=t.pageY):(this.x=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,this.y=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),this.x-=this.container.offsetLeft,this.y-=this.container.offsetTop},t.instance=new t,t}();e.Mouse=o},function(t,e){"use strict";var i=function(){function t(){}return t}();e.Touch=i},function(t,e,i){"use strict";var r=i(31);e.degreeToRadian=r.degreeToRadian,e.radianToDegree=r.radianToDegree;var o=i(7);e.Http=o.Http;var n=i(8);e.PI=n.PI,e.capitalize=n.capitalize;var s=i(4);e.ResourceManager=s.ResourceManager},function(t,e,i){"use strict";var r=i(9),o=i(32),n=function(){function t(t,e,i){this.health=5,this.armor=0,this.damage=10,this.worth=100,this.dead=!1,this.speed=.07,this.fireTimeout=0,this.msBetweenRounds=1e3,this.projectiles=[],this.gl=t,this.texture=e,this.collider=i,this.baseSprite=new r.GL.Sprite(this.texture,16,16,[400,0,16,16]),this.dirSprite=new r.GL.Sprite(this.texture,16,16,[416,16,16,16]),this.direction=new r.Geometry.Vector2(0,0),this.msBetweenRounds=1e3*Math.random()-500+1e3}return t.prototype.update=function(t,e){this.direction=this.seek(new r.Geometry.Vector2(e.collider.pos.x,e.collider.pos.y)),this.updateMovement(this.direction,t),this.fireTimeout+=t,this.fireTimeout>this.msBetweenRounds&&(this.fireTimeout=0,this.projectiles.push(new o.Projectile(this.gl,this.texture,new r.Geometry.Circle(this.collider.pos.x,this.collider.pos.y,3),.6,this.damage,this.direction.copy())));for(var i in this.projectiles)this.projectiles[+i].update(t),this.projectiles[+i].isDead()&&this.projectiles.splice(+i,1)},t.prototype.render=function(t){this.baseSprite.renderAngleScale(t,this.collider.pos.x-this.collider.radius,this.collider.pos.y-this.collider.radius,r.Utility.radianToDegree(this.direction.angle()),2);for(var e in this.projectiles)this.projectiles[+e].render(t)},t.prototype.getProjectiles=function(){return this.projectiles},t.prototype.getCollider=function(){return this.collider},t.prototype.getWorth=function(){return this.worth},t.prototype.doDamage=function(t){this.health-=t,this.health<0&&(this.dead=!0)},t.prototype.isDead=function(){return this.dead},t.prototype.seek=function(t){var e=new r.Geometry.Vector2(this.collider.pos.x,this.collider.pos.y);return t.sub(e).normalize()},t.prototype.updateMovement=function(t,e){var i=new r.Geometry.Vector2(this.collider.pos.x,this.collider.pos.y);t=t.scale(this.speed*e),i=i.add(t),this.collider.setX(i.x),this.collider.setY(i.y)},t}();e.Enemy=n},function(t,e,i){"use strict";var r=i(9),o=i(79),n=i(77),s=function(){function t(){this.width=800,this.height=600,this.targetFps=60,this.backgroundColor=new r.Graphics.Color(50,50,50),this.enemies=[],this.splatter=[],this.paused=!1,this.showGameover=!1,this.killCount=0,this.spawns=[],this.spawnTimeout=0,this.spawnTime=1e4,this.spawnSprites=[],this.enemyPoints=[new r.Geometry.Point(400,100),new r.Geometry.Point(50,350),new r.Geometry.Point(750,350),new r.Geometry.Point(400,560)],this.enemyTimeout=0,this.enemyTime=1e3;var t=this;this.application=new r.Application(this.width,this.height,this.targetFps),this.scene=this.application.sceneManager.addScene("menu"),this.scene.add3dSurface("main"),this.scene.render=function(e){t.render(e)},this.scene.update=function(e){t.update(e)},this.gl=this.scene.getContext("main");var e=this.backgroundColor.getRGBAFloat();this.gl.clearColor(e[0],e[1],e[2],1),this.mouse=r.Input.Mouse.getInstance(),this.keyboard=r.Input.Keyboard.getInstance(),this.mouse.init(),this.renderer=new r.GL.Render2d.Renderer2d(this.gl),this.texture=new r.GL.Texture(this.gl,"../assets/img/texture.png"),this.texture.width=512,this.texture.height=512,this.backgroundSprite=new r.GL.Sprite(this.texture,400,300,[0,0,400,300]),this.healthSprite=new r.GL.Sprite(this.texture,7,7,[432,0,7,7]),this.armorSprite=new r.GL.Sprite(this.texture,7,7,[440,0,7,7]),this.gameoverSprite=new r.GL.Sprite(this.texture,160,96,[0,304,160,96]),this.splatterSprite=new r.GL.Sprite(this.texture,16,16,[432,16,16,16]),this.spawnSprites=[new r.GL.Sprite(this.texture,32,16,[400,64,32,16]),new r.GL.Sprite(this.texture,32,16,[400,48,32,16]),new r.GL.Sprite(this.texture,16,16,[400,32,16,16]),new r.GL.Sprite(this.texture,16,16,[416,32,16,16]),new r.GL.Sprite(this.texture,16,16,[432,32,16,16]),new r.GL.Sprite(this.texture,16,16,[448,32,16,16]),new r.GL.Sprite(this.texture,16,16,[464,32,16,16])],this.fontRenderer=new r.GL.Font.FontRenderer(this.gl),this.font=new r.GL.Font.Font(this.gl,"../assets/data/default.xml"),this.player=new o.Player(this.gl,this.texture),this.application.init()}return t.prototype.update=function(t){var e=r.Input.Key;if((this.keyboard.keys[e.PAUSE]||this.keyboard.keys[e.P])&&(this.paused=!this.paused,this.keyboard.keys[e.PAUSE]=!1,this.keyboard.keys[e.P]=!1),!this.paused){this.player.update(t),this.updateEnemies(t),this.updatePowerupWeaponSpawn(t);for(var i in this.spawns)r.Geometry.intersects(this.player.collider,this.spawns[+i].collider)&&("weapon"===this.spawns[+i].type?this.player.applyWeapon(this.spawns[+i].id,this.spawns[+i].sprite):this.player.applyPowerUp(this.spawns[+i].id,this.spawns[+i].sprite),this.spawns.splice(+i,1));this.checkProjectileCollision(),this.player.health<0&&(this.paused=!0,this.showGameover=!0)}this.showGameover&&this.mouse.button[0]&&this.resetGame()},t.prototype.render=function(t){this.scene.clear("main"),this.backgroundSprite.renderScale(this.renderer,0,0,2);for(var e=0,i=this.splatter;e<i.length;e++){var r=i[e];this.splatterSprite.renderScale(this.renderer,r.x,r.y,2)}this.player.render(this.renderer);for(var o in this.enemies)this.enemies[+o].render(this.renderer);for(var n in this.spawns){var s=this.spawns[+n].collider;this.spawns[+n].sprite.renderScale(this.renderer,s.pos.x-s.halfWidth,s.pos.y-s.halfHeight,2)}this.renderStatus(),this.renderer.execute(),this.fontRenderer.execute()},t.prototype.renderStatus=function(){var t=70*(this.player.health/this.player.maxHealth),e=70*(this.player.armor/this.player.maxArmor);e<0&&(e=0),t<0&&(t=0),this.healthSprite.width=t,this.armorSprite.width=e,this.healthSprite.renderScale(this.renderer,450,10,2),this.armorSprite.renderScale(this.renderer,450,38,2),this.font.align=2,this.font.drawString(this.fontRenderer,this.player.getScore(),770,16),this.font.align=1,this.font.drawString(this.fontRenderer,this.killCount.toString(),88,8),this.font.drawString(this.fontRenderer,this.player.getAmmo(),360,10),this.showGameover&&this.gameoverSprite.renderScale(this.renderer,240,176,2)},t.prototype.updatePowerupWeaponSpawn=function(t){if(this.spawnTimeout+=t,this.spawnTimeout>this.spawnTime){this.spawnTimeout=0;var e=10*Math.random()>7;if(e){var i=10*Math.random()>7?1:2,o=600*Math.random()+100,n=400*Math.random()+150,s=this.spawnSprites[i-1];this.spawns.push({type:"weapon",id:i,collider:new r.Geometry.AABB(o,n,32,16),sprite:s})}else{var a=Math.floor(5*Math.random()),o=600*Math.random()+100,n=400*Math.random()+150,s=void 0;switch(a){case 0:s=this.spawnSprites[2];break;case 1:s=this.spawnSprites[3];break;case 2:s=this.spawnSprites[4];break;case 3:s=this.spawnSprites[5];break;case 4:s=this.spawnSprites[6];break;case 5:s=this.spawnSprites[2]}this.spawns.push({type:"powerup",id:a,collider:new r.Geometry.AABB(o,n,16,16),sprite:s})}}},t.prototype.updateEnemies=function(t){for(var e in this.enemies)this.enemies[+e].update(t,this.player),this.enemies[+e].isDead()&&(this.killCount+=1,this.player.addScore(this.enemies[+e].getWorth()),this.splatter.push(new r.Geometry.Point(this.enemies[+e].collider.pos.x-16,this.enemies[+e].collider.pos.y-16)),this.enemies.splice(+e,1));if(this.enemyTimeout+=t,this.enemyTimeout>this.enemyTime){this.enemyTimeout=0;var i=this.enemyPoints[Math.floor(4*Math.random())];this.enemies.push(new n.Enemy(this.gl,this.texture,new r.Geometry.Circle(i.x,i.y,16)))}},t.prototype.checkProjectileCollision=function(){var t=this.player.getProjectiles(),e=this.player.getCollider();for(var i in t)for(var o in this.enemies){var n=this.enemies[+o].getCollider();r.Geometry.intersects(t[+i].collider,n)&&(this.enemies[+o].doDamage(t[+i].damage),t[+i].dead=!0)}for(var o in this.enemies){var s=this.enemies[+o].projectiles;for(var i in s)r.Geometry.intersects(s[+i].collider,e)&&(this.player.doDamage(s[+i].damage),s[+i].dead=!0)}},t.prototype.resetGame=function(){this.player=new o.Player(this.gl,this.texture),this.spawns=[],this.enemies=[],this.killCount=0,this.spawnTimeout=0,this.enemyTimeout=0,this.showGameover=!1,this.paused=!1},t}();e.Game=s},function(t,e,i){"use strict";var r=i(9),o=i(32),n=i(81),s=i(80),a=function(){function t(t,e){this.health=100,this.maxHealth=100,this.armor=50,this.maxArmor=100,this.score=0,this.fireCooldown=0,this.speedBoost=!1,this.quadDamage=!1,this.speed=.2,this.projectiles=[],this.gl=t,this.texture=e,this.collider=new r.Geometry.Circle(400,300,16),this.baseSprite=new r.GL.Sprite(this.texture,16,16,[416,0,16,16]),this.dirSprite=new r.GL.Sprite(this.texture,16,16,[416,16,16,16]),this.direction=new r.Geometry.Vector2(0,0),this.weapon=new n.Weapon,this.weapon.setWeapon(0,null),this.mouse=r.Input.Mouse.getInstance(),this.keyboard=r.Input.Keyboard.getInstance()}return t.prototype.update=function(t){this.calculateDirection(),this.updateMovement(this.handleInput(t),t),this.powerup&&(this.powerup.update(t),this.powerup.isActive()||(this.powerup=null,this.speedBoost=!1,this.quadDamage=!1));for(var e in this.projectiles)this.projectiles[+e].update(t),this.projectiles[+e].isDead()&&this.projectiles.splice(+e,1)},t.prototype.render=function(t){this.baseSprite.renderAngleScale(t,this.collider.pos.x-this.collider.radius,this.collider.pos.y-this.collider.radius,r.Utility.radianToDegree(this.direction.angle()),2),this.powerup&&this.powerup.render(t),0!==this.weapon.type&&this.weapon.render(t);for(var e in this.projectiles)this.projectiles[+e].render(t)},t.prototype.getProjectiles=function(){return this.projectiles},t.prototype.getCollider=function(){return this.collider},t.prototype.addScore=function(t){this.score+=t},t.prototype.getScore=function(){return this.score.toString()},t.prototype.getAmmo=function(){return this.weapon.ammo.toString()},t.prototype.doDamage=function(t){this.health-=t},t.prototype.applyWeapon=function(t,e){this.weapon.setWeapon(t,e)},t.prototype.applyPowerUp=function(t,e){switch(t){case 0:this.health+=25;break;case 1:this.health+=50;break;case 2:this.health+=100;break;case 3:this.speedBoost=!0,this.quadDamage=!1,this.powerup=new s.Powerup(e,2e4);break;case 4:this.quadDamage=!0,this.speedBoost=!1,this.powerup=new s.Powerup(e,1e4)}this.health>100&&(this.health=100)},t.prototype.calculateDirection=function(){var t=new r.Geometry.Vector2(this.mouse.x,this.mouse.y),e=new r.Geometry.Vector2(this.collider.pos.x,this.collider.pos.y);this.direction=t.sub(e).normalize()},t.prototype.handleInput=function(t){var e=r.Input.Key,i=new r.Geometry.Vector2(0,0);return this.keyboard.keys[e.W]&&(i=i.add(new r.Geometry.Vector2(0,-1))),this.keyboard.keys[e.A]&&(i=i.add(new r.Geometry.Vector2(-1,0))),this.keyboard.keys[e.S]&&(i=i.add(new r.Geometry.Vector2(0,1))),this.keyboard.keys[e.D]&&(i=i.add(new r.Geometry.Vector2(1,0))),this.mouse.button[0]&&this.fireWeapon(t),i.normalize()},t.prototype.fireWeapon=function(t){var e=!0,i=this.weapon.damage;switch(this.quadDamage&&(i*=4),this.weapon.autoFire?(this.fireCooldown-=t,this.fireCooldown>0&&(e=!1)):this.mouse.button[0]=!1,this.weapon.type){case 0:this.projectiles.push(new o.Projectile(this.gl,this.texture,new r.Geometry.Circle(this.collider.pos.x,this.collider.pos.y,3),.6,i,this.direction.copy()));break;case 1:this.projectiles.push(new o.Projectile(this.gl,this.texture,new r.Geometry.Circle(this.collider.pos.x,this.collider.pos.y,3),.6,i,this.direction.rotate(-.125))),this.projectiles.push(new o.Projectile(this.gl,this.texture,new r.Geometry.Circle(this.collider.pos.x,this.collider.pos.y,3),.6,i,this.direction.rotate(-.062))),this.projectiles.push(new o.Projectile(this.gl,this.texture,new r.Geometry.Circle(this.collider.pos.x,this.collider.pos.y,3),.6,i,this.direction.copy())),this.projectiles.push(new o.Projectile(this.gl,this.texture,new r.Geometry.Circle(this.collider.pos.x,this.collider.pos.y,3),.6,i,this.direction.rotate(.062))),this.projectiles.push(new o.Projectile(this.gl,this.texture,new r.Geometry.Circle(this.collider.pos.x,this.collider.pos.y,3),.6,i,this.direction.rotate(.125))),this.weapon.useAmmo();break;case 2:e&&(this.projectiles.push(new o.Projectile(this.gl,this.texture,new r.Geometry.Circle(this.collider.pos.x,this.collider.pos.y,3),.6,i,this.direction.copy())),this.weapon.useAmmo(),this.fireCooldown=100)}},t.prototype.updateMovement=function(t,e){var i=new r.Geometry.Vector2(this.collider.pos.x,this.collider.pos.y);t=this.speedBoost?t.scale(2*this.speed*e):t.scale(this.speed*e),i=i.add(t),i.y>530&&(i.y=530),i.y<140&&(i.y=140),i.x<80&&(i.x=80),i.x>720&&(i.x=720),this.collider.setX(i.x),this.collider.setY(i.y)},t}();e.Player=a},function(t,e){"use strict";var i=function(){function t(t,e){this.sprite=t,this.timeout=e,this.active=!0}return t.prototype.update=function(t){this.timeout-=t,this.timeout<0&&(this.active=!1)},t.prototype.render=function(t){this.sprite.renderScale(t,143,10,2)},t.prototype.isActive=function(){return this.active},t.prototype.getRemainingTime=function(){return this.timeout},t}();e.Powerup=i},function(t,e){"use strict";var i=[{type:0,name:"Widowmaker",damage:5,autoFire:!1,melee:!1,startAmmo:0},{type:1,name:"Shotgun",damage:10,autoFire:!1,melee:!1,startAmmo:20},{type:2,name:"Minigun",damage:5,autoFire:!0,melee:!1,startAmmo:100}],r=function(){function t(){}return t.prototype.setWeapon=function(t,e){var r=i[t];this.type=r.type,this.name=r.name,this.damage=r.damage,this.autoFire=r.autoFire,this.melee=r.melee,this.startAmmo=r.startAmmo,this.ammo=r.startAmmo,this.sprite=e},t.prototype.useAmmo=function(){this.ammo-=1,0===this.ammo&&this.setWeapon(0,null)},t.prototype.render=function(t){this.sprite.renderScale(t,220,12,2)},t}();e.Weapon=r}])});
//# sourceMappingURL=ld37.min.js.map